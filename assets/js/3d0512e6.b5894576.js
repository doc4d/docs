"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[38223],{422006:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>i,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var n=t(474848),s=t(28453);const r={id:"sql-execute",title:"SQL EXECUTE",slug:"/commands/sql-execute",displayed_sidebar:"docs"},l=void 0,o={id:"commands-legacy/sql-execute",title:"SQL EXECUTE",description:"SQL EXECUTE ( sqlStatement {; boundObj}{; boundObj2 ; ... ; boundObjN} )",source:"@site/docs/commands-legacy/sql-execute.md",sourceDirName:"commands-legacy",slug:"/commands/sql-execute",permalink:"/docs/next/commands/sql-execute",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fsql-execute.md%20(current)&body=Please%20enter%20your%20comment%3A",tags:[],version:"current",frontMatter:{id:"sql-execute",title:"SQL EXECUTE",slug:"/commands/sql-execute",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"SQL End selection",permalink:"/docs/next/commands/sql-end-selection"},next:{title:"SQL EXECUTE SCRIPT",permalink:"/docs/next/commands/sql-execute-script"}},i={},d=[{value:"Description",id:"description",level:4},{value:"Example 1",id:"example-1",level:4},{value:"Example 2",id:"example-2",level:4},{value:"Example 3",id:"example-3",level:4},{value:"Example 4",id:"example-4",level:4},{value:"Example 5",id:"example-5",level:4},{value:"Example 6",id:"example-6",level:4},{value:"System variables and sets",id:"system-variables-and-sets",level:4},{value:"See also",id:"see-also",level:4}];function c(e){const a={a:"a",code:"code",em:"em",h4:"h4",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"SQL EXECUTE"})," ( ",(0,n.jsx)(a.em,{children:"sqlStatement"})," {; ",(0,n.jsx)(a.em,{children:"boundObj"}),"}{; ",(0,n.jsx)(a.em,{children:"boundObj2"})," ; ... ; ",(0,n.jsx)(a.em,{children:"boundObjN"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Parameter"}),(0,n.jsx)(a.th,{children:"Type"}),(0,n.jsx)(a.th,{}),(0,n.jsx)(a.th,{children:"Description"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"sqlStatement"}),(0,n.jsx)(a.td,{children:"Text"}),(0,n.jsx)(a.td,{children:"\u2192"}),(0,n.jsx)(a.td,{children:"SQL command to execute"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"boundObj"}),(0,n.jsx)(a.td,{children:"Variable, Field"}),(0,n.jsx)(a.td,{children:"\u2190"}),(0,n.jsx)(a.td,{children:"Receives result (if necessary)"})]})]})]}),"\n",(0,n.jsx)(a.h4,{id:"description",children:"Description"}),"\n",(0,n.jsx)(a.p,{children:"The SQL EXECUTE command executes an SQL command and binds the result to 4D objects (arrays, variables or fields)."}),"\n",(0,n.jsx)(a.p,{children:"A valid connection must be specified in the current process in order to execute this command."}),"\n",(0,n.jsxs)(a.p,{children:["The ",(0,n.jsx)(a.em,{children:"sqlStatement"})," parameter contains the SQL command to execute. ",(0,n.jsx)(a.em,{children:"boundObj"})," receives the results. Variables are bound in the column sequence order, which means that any remaining remote columns are discarded."]}),"\n",(0,n.jsxs)(a.p,{children:["If 4D fields are passed as parameters in ",(0,n.jsx)(a.em,{children:"boundObj"}),", the command will create records and save them automatically. 4D fields must come from the same table (a field from table 1 and a field from table 2 cannot be passed in the same call). If fields from more than one table are passed, an error is generated."]}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Warning:"})," When you pass 4D fields in the ",(0,n.jsx)(a.em,{children:"boundObj"})," parameter(s) and execute the ",(0,n.jsx)(a.em,{children:"SELECT"})," command, it is always the data of the remote 4D source that is modified. If you want to retrieve data from the remote source locally, you must use intermediary local arrays and call the ",(0,n.jsx)(a.em,{children:"INSERT"})," command (see example 6)."]}),"\n",(0,n.jsxs)(a.p,{children:["If you pass 4D arrays in the ",(0,n.jsx)(a.em,{children:"boundObj"})," parameter(s), it is advisable to declare them before calling the command in order to check the type of data processed. Arrays are automatically resized when necessary."]}),"\n",(0,n.jsx)(a.p,{children:"With a 4D variable, one record is fetched at a time. The other results are ignored."}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Note:"})," For more information about referencing 4D expressions in SQL queries, refer to the ",(0,n.jsx)(a.em,{children:"Overview of SQL Commands"})," section."]}),"\n",(0,n.jsx)(a.h4,{id:"example-1",children:"Example 1"}),"\n",(0,n.jsx)(a.p,{children:"In this example, we will get the ename column of the emp table of the data source. The result is stored in the [Employee]Name 4D field. 4D records will be created automatically:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0SQLStmt:="SELECT ename FROM emp"\n\xa0SQL EXECUTE(SQLStmt;[Employee]Name)\n\xa0SQL LOAD RECORD(SQL all records)\n'})}),"\n",(0,n.jsx)(a.h4,{id:"example-2",children:"Example 2"}),"\n",(0,n.jsx)(a.p,{children:"To check the creation of records, it is possible to include code within a transaction and to validate it only if the operation proves to be satisfactory:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0SQL LOGIN("mysql";"root";"")\n\xa0SQLStmt:="SELECT alpha_field FROM app_testTable"\n\xa0START TRANSACTION\n\xa0SQL EXECUTE(SQLStmt;[Table 2]Field1)\n\xa0While(Not(SQL End selection))\n\xa0\xa0\xa0\xa0SQL LOAD RECORD\n\xa0\xa0\xa0\xa0...\xa0//Place the data validation code here\n\xa0End while\n\xa0VALIDATE TRANSACTION\xa0//Validation of the transaction\n'})}),"\n",(0,n.jsx)(a.h4,{id:"example-3",children:"Example 3"}),"\n",(0,n.jsxs)(a.p,{children:["In this example, we want to get the ename column of the emp table of the data source. The result will be stored in an ",(0,n.jsx)(a.em,{children:"aName"})," array. We fetch records 10 at a time."]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0ARRAY STRING(30;aName;20)\n\xa0SQLStmt:="SELECT ename FROM emp"\n\xa0SQL EXECUTE(SQLStmt;aName)\n\xa0While(Not(SQL End selection))\n\xa0\xa0\xa0\xa0SQL LOAD RECORD(10)\n\xa0End while\n'})}),"\n",(0,n.jsx)(a.h4,{id:"example-4",children:"Example 4"}),"\n",(0,n.jsxs)(a.p,{children:["In this example, we want to get the ename and job of the emp table for a specific ID (WHERE clause) of the data source. The result will be stored in the ",(0,n.jsx)(a.em,{children:"vName"})," and ",(0,n.jsx)(a.em,{children:"vJob"})," 4D variables. Only the first record is fetched."]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0SQLStmt:="SELECT ename, job FROM emp WHERE id = 3"\n\xa0SQL EXECUTE(SQLStmt;vName;vJob)\n\xa0SQL LOAD RECORD\n'})}),"\n",(0,n.jsx)(a.h4,{id:"example-5",children:"Example 5"}),"\n",(0,n.jsx)(a.p,{children:"In this example, we want to get the Blob_Field column of the Test table in the data source. The result will be stored in a BLOB variable whose value is updated each time a record is loaded."}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0var MyBlob : Blob\n\xa0SQL LOGIN\n\xa0SQL EXECUTE("SELECT Blob_Field FROM Test";MyBlob)\n\xa0While(Not(SQL End selection))\n\xa0\xa0//We look through the results\n\xa0\xa0\xa0\xa0SQL LOAD RECORD\n\xa0\xa0//The value of MyBlob is updated on each call\n\xa0End while\n'})}),"\n",(0,n.jsx)(a.h4,{id:"example-6",children:"Example 6"}),"\n",(0,n.jsx)(a.p,{children:"You want to retrieve data locally from a remote 4D Server database where it is stored. To do this, you must use intermediary arrays:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0\xa0// Log in to the remote database\n\xa0SQL LOGIN("IP:192.168.18.15:19812";"user";"password";*)\n\xa0If(OK=1)\n\xa0\xa0// Starting from here all SQL requests are made on the remote database\n\xa0\xa0\xa0\xa0var $LastName_value : Text\xa0// 4D variable used in the search statement\n\xa0\xa0\xa0\xa0ARRAY TEXT($a_LastName;0)\xa0// Temporary storage of remote values for LastName\n\xa0\xa0\xa0\xa0ARRAY TEXT($a_FirstName;0)\xa0// Temporary storage of remote values for FirstName\n\xa0\xa0\xa0\xa0var $UseSQL : Boolean\xa0//Choice of means for local storage of data from the remote database\n\xa0\xa0// (demo only)\n\xa0\n\xa0\xa0\xa0\xa0$LastName_value:="Smith"\xa0// Initialization of 4D variable\n\xa0\n\xa0\xa0// Associate the 4D $LastName_value variable with the first "?" in the SQL request\n\xa0\xa0\xa0\xa0SQL SET PARAMETER($LastName_value;SQL param in)\n\xa0\n\xa0\xa0// From the remote PERSONS table, retrieve the values of the LastName and FirstName fields\n\xa0\xa0// where "LastName = Smith" and store them in the $a_LastName and $a_FirstName arrays\n\xa0\xa0\xa0\xa0SQL EXECUTE("SELECT LastName, FirstName FROM PERSONS WHERE LastName = ?";$a_LastName;$a_FirstName)\n\xa0\xa0\xa0\xa0If(Not(SQL End selection))\xa0// If at least one record is found\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL LOAD RECORD(SQL all records)\xa0// Load all the records\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$UseSQL:=True\xa0// Chooses the way to integrate the data (demo only)\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If($UseSQL)\xa0// Use SQL requests\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL LOGOUT\xa0// Log out from the remote database\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL LOGIN(SQL_INTERNAL;"user";"password")\xa0// Log in to the local database\n\xa0\xa0// Starting from here all SQL requests are made on the local database\n\xa0\xa0// Save the $a_LastName and $a_FirstName arrays in the local PERSONS table\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL EXECUTE("INSERT INTO PERSONS(LastName, FirstName) VALUES (:$a_LastName, :$a_FirstName);")\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\xa0// Using 4D commands\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0For($i;1;Size of array($a_LastName))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0CREATE RECORD([PERSONS])\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[PERSONS]LastName:=$a_LastName{$i}\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[PERSONS]FirstName:=$a_FirstName{$i}\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SAVE RECORD([PERSONS])\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0End for\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0SQL LOGOUT\xa0// Close the connection\n\xa0End if\n'})}),"\n",(0,n.jsx)(a.h4,{id:"system-variables-and-sets",children:"System variables and sets"}),"\n",(0,n.jsx)(a.p,{children:"If the command has been executed correctly, the system variable OK returns 1. Otherwise, it returns 0."}),"\n",(0,n.jsx)(a.h4,{id:"see-also",children:"See also"}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.a,{href:"/docs/next/commands/sql-load-record",children:"SQL LOAD RECORD"})})]})}function m(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,a,t)=>{t.d(a,{R:()=>l,x:()=>o});var n=t(296540);const s={},r=n.createContext(s);function l(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);