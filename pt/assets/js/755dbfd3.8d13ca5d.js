"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[85543],{628467:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>c,contentTitle:()=>d,default:()=>i,frontMatter:()=>r,metadata:()=>t,toc:()=>m});var s=o(474848),n=o(28453);const r={id:"sql-execute",title:"SQL EXECUTE",slug:"/commands/sql-execute",displayed_sidebar:"docs"},d=void 0,t={id:"commands-legacy/sql-execute",title:"SQL EXECUTE",description:"SQL EXECUTE ( instrucaoSQL {; objAssoc}{; objAssoc2 ; ... ; objAssocN} )",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/commands-legacy/sql-execute.md",sourceDirName:"commands-legacy",slug:"/commands/sql-execute",permalink:"/docs/pt/next/commands/sql-execute",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fsql-execute.md%20(current)&body=Please%20enter%20your%20comment%3A",tags:[],version:"current",frontMatter:{id:"sql-execute",title:"SQL EXECUTE",slug:"/commands/sql-execute",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"SQL End selection",permalink:"/docs/pt/next/commands/sql-end-selection"},next:{title:"SQL EXECUTE SCRIPT",permalink:"/docs/pt/next/commands/sql-execute-script"}},c={},m=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:4},{value:"Exemplo 1",id:"exemplo-1",level:4},{value:"Exemplo 2",id:"exemplo-2",level:4},{value:"Exemplo 3",id:"exemplo-3",level:4},{value:"Exemplo 4",id:"exemplo-4",level:4},{value:"Exemplo 5",id:"exemplo-5",level:4},{value:"Exemplo 6",id:"exemplo-6",level:4},{value:"Vari\xe1veis e conjuntos do sistema",id:"vari\xe1veis-e-conjuntos-do-sistema",level:4},{value:"Ver tamb\xe9m",id:"ver-tamb\xe9m",level:4}];function l(e){const a={a:"a",code:"code",em:"em",h4:"h4",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.strong,{children:"SQL EXECUTE"})," ( ",(0,s.jsx)(a.em,{children:"instrucaoSQL"})," {; ",(0,s.jsx)(a.em,{children:"objAssoc"}),"}{; ",(0,s.jsx)(a.em,{children:"objAssoc2"})," ; ... ; ",(0,s.jsx)(a.em,{children:"objAssocN"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(a.table,{children:[(0,s.jsx)(a.thead,{children:(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.th,{children:"Par\xe2metro"}),(0,s.jsx)(a.th,{children:"Tipo"}),(0,s.jsx)(a.th,{}),(0,s.jsx)(a.th,{children:"Descri\xe7\xe3o"})]})}),(0,s.jsxs)(a.tbody,{children:[(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"instrucaoSQL"}),(0,s.jsx)(a.td,{children:"Texto"}),(0,s.jsx)(a.td,{children:"\ud83e\udc52"}),(0,s.jsx)(a.td,{children:"Comando SQL a executar"})]}),(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"objAssoc"}),(0,s.jsx)(a.td,{children:"Vari\xe1vel, Campo"}),(0,s.jsx)(a.td,{children:"\ud83e\udc58"}),(0,s.jsx)(a.td,{children:"Recebe resultado (se necess\xe1rio)"})]})]})]}),"\n",(0,s.jsx)(a.h4,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsx)(a.p,{children:"O comando SQL EXECUTE \xe9 utilizado para executar um comando SQL e associar o resultado a objetos 4D (arrays, vari\xe1veis ou campos)."}),"\n",(0,s.jsx)(a.p,{children:"Para que o comando possa ser executado, uma conex\xe3o v\xe1lida precisa ser especificada no processo atual."}),"\n",(0,s.jsxs)(a.p,{children:["O par\xe2metro ",(0,s.jsx)(a.em,{children:"instrucaoSQL"})," contem o comando SQL a executar. ",(0,s.jsx)(a.em,{children:"objAssoc"})," recebe os resultados. As vari\xe1veis est\xe3o associadas na ordem de sequ\xeancia da coluna, o que significa que as colunas restantes s\xe3o ignoradas.."]}),"\n",(0,s.jsxs)(a.p,{children:["Se os campos 4D s\xe3o passados como par\xe2metros em ",(0,s.jsx)(a.em,{children:"objAssoc"}),", o comando criar\xe1 registros e os guardar\xe1 automaticamente. Os campos 4D devem vir da mesma tabela (n\xe3o \xe9 poss\xedvel passar um campo da tabela 1 e um campo da tabela 2 na mesma chamada). Se forem passados campos de diferentes tabelas, um erro \xe9 gerado."]}),"\n",(0,s.jsxs)(a.p,{children:["Aten\xe7\xe3o: Quando passe os campos 4D nos par\xe2metros ",(0,s.jsx)(a.em,{children:"objAssoc"})," e execute o comando ",(0,s.jsx)(a.em,{children:"SELECT"}),", sempre s\xe3o os dados da fonte 4D remota os que se modificam. Se voc\xea quer recuperar dados de uma fonte remota localmente, deve utilizar arrays locais intermedi\xe1rios e chamar ao comando ",(0,s.jsx)(a.em,{children:"INSERT"})," (ver o exemplo 6)."]}),"\n",(0,s.jsxs)(a.p,{children:["Se passa arrays 4D nos par\xe2metros ",(0,s.jsx)(a.em,{children:"objAssoc"}),", \xe9 recomend\xe1vel declarar antes de chamar o comando com o objetivo de controlar o tipo de dados processados. Os arrays s\xe3o redimensionados automaticamente quando for necess\xe1rio."]}),"\n",(0,s.jsx)(a.p,{children:"No caso de uma vari\xe1vel 4D, apenas um registro \xe9 recuperado a cada vez. Os outros resultados s\xe3o ignorados.."}),"\n",(0,s.jsxs)(a.p,{children:["Nota: Para maior informa\xe7\xe3o sobre o referenciado das express\xf5es 4D em pesquisas SQL, consulte a se\xe7\xe3o ",(0,s.jsx)(a.em,{children:"Introdu\xe7\xe3o aos comandos SQL"}),"."]}),"\n",(0,s.jsx)(a.h4,{id:"exemplo-1",children:"Exemplo 1"}),"\n",(0,s.jsx)(a.p,{children:"Neste exemplo, obteremos a coluna ename da tabela emp da fonte de dados externos. O resultado \xe9 armazenado no campo 4D [Empregados]Nome. Os registros 4D s\xe3o criados automaticamente:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-4d",children:'\xa0SQLStmt:="SELECT ename FROM emp"\n\xa0SQL EXECUTE(SQLStmt;[Empregados]Nome)\n\xa0SQL LOAD RECORD(SQL all records)\n'})}),"\n",(0,s.jsx)(a.h4,{id:"exemplo-2",children:"Exemplo 2"}),"\n",(0,s.jsx)(a.p,{children:"Para controlar a cria\xe7\xe3o de registros, \xe9 poss\xedvel incluir o c\xf3digo numa transa\xe7\xe3o e confirm\xe1-la unicamente se a opera\xe7\xe3o teste for satisfat\xf3ria:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-4d",children:'\xa0SQL LOGIN("mysql";"root";"")\n\xa0SQLStmt:="SELECT campo _alfa FROM ap_Tabela_Testea"\n\xa0START TRANSACTION\n\xa0SQL EXECUTE(SQLStmt;[Tabela 2]Campo1)\n\xa0While(Not(SQL End selection))\n\xa0\xa0\xa0\xa0SQL LOAD RECORD\n\xa0\xa0\xa0\xa0...\xa0//Escrever o c\xf3digo de valida\xe7\xe3o de dados aqui\n\xa0End while\n\xa0VALIDATE TRANSACTION\xa0//Valida\xe7\xe3o da transa\xe7\xe3o\n'})}),"\n",(0,s.jsx)(a.h4,{id:"exemplo-3",children:"Exemplo 3"}),"\n",(0,s.jsxs)(a.p,{children:["Neste exemplo, queremos obter a coluna ename da tabela emp da fonte de dados externos. O resultado ser\xe1 armazenado em um array ",(0,s.jsx)(a.em,{children:"Nome"}),". Obtemos os registros de 10 em 10."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-4d",children:'\xa0ARRAY STRING(30;Nome;20)\n\xa0SQLStmt:="SELECT ename FROM emp"\n\xa0SQL EXECUTE(SQLStmt;Nome)\n\xa0While(Not(SQL End selection))\n\xa0\xa0\xa0\xa0SQL LOAD RECORD(10)\n\xa0End while\n'})}),"\n",(0,s.jsx)(a.h4,{id:"exemplo-4",children:"Exemplo 4"}),"\n",(0,s.jsxs)(a.p,{children:["Neste exemplo, queremos obter as colunas ename e job da tabela emp para um ID especifico ID (cl\xe1usula WHERE) da fonte de dados externa. O resultado \xe9 armazena nas vari\xe1veis 4D ",(0,s.jsx)(a.em,{children:"vNome"})," e ",(0,s.jsx)(a.em,{children:"vJob"}),". S\xf3 se recupera o primeiro registro."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-4d",children:'\xa0SQLStmt:="SELECT ename, job FROM emp WHERE id = 3"\n\xa0SQL EXECUTE(SQLStmt;vNome;vJob)\n\xa0SQL LOAD RECORD\n'})}),"\n",(0,s.jsx)(a.h4,{id:"exemplo-5",children:"Exemplo 5"}),"\n",(0,s.jsx)(a.p,{children:"Neste exemplo, queremos obter a coluna Campo_Blob da tabela Test na fonte de dados. O resultado \xe9 armazenado em uma vari\xe1vel BLOB cujo valor \xe9 atualizado cada vez que um registro for carregado."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-4d",children:'\xa0var MeuBlob : Blob\n\xa0SQL LOGIN\n\xa0SQL EXECUTE("SELECT Campo_Blob FROM Test";MeuBlob)\n\xa0While(Not(SQL End selection))\n\xa0\xa0//Buscamos nos resultados\n\xa0\xa0\xa0\xa0SQL LOAD RECORD\n\xa0\xa0//O valor de MeuBlob \xe9 atualizado a cada chamada\n'})}),"\n",(0,s.jsx)(a.h4,{id:"exemplo-6",children:"Exemplo 6"}),"\n",(0,s.jsx)(a.p,{children:"Para recuperar dados localmente de um banco de dados remoto 4D server onde est\xe1 armazenado. Para fazer isso, deve usar arrays intermedi\xe1rios:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-4d",children:'\xa0\xa0// Log in ao banco de dados remoto\n\xa0SQL LOGIN("IP:192.168.18.15:19812";"user";"password";*)\n\xa0If(OK=1)\n\xa0\xa0// Come\xe7ando daqui todos os SQL requests ser\xe3o feitas no banco de dados remoto\n\xa0\xa0\xa0\xa0var $LastName_value : Text\xa0// 4D variable usada em search statement\n\xa0\xa0\xa0\xa0ARRAY TEXT($a_LastName;0)\xa0// Armazenamento Tempor\xe1rio dos valores remotos para LastName\n\xa0\xa0\xa0\xa0ARRAY TEXT($a_FirstName;0)\xa0// Armazenamento tempor\xe1rio dos valores remotos para FirstName\n\xa0\xa0\xa0\xa0var $UseSQL : Boolean\xa0//Escolha dos modos para armazenamento local de dados do banco de dados remoto\n\xa0\xa0// (demo only)\n\xa0\n\xa0\xa0\xa0\xa0$LastName_value:="Smith"\xa0// Initializa o 4D variable\n\xa0\n\xa0\xa0// Associa o 4D $LastName_value vari\xe1vel com o primeiro\xa0 "?" em SQL request\n\xa0\xa0\xa0\xa0SQL SET PARAMETER($LastName_value;SQL param in)\n\xa0\n\xa0\xa0// Da tabela remota PERSONS, recupera os valores dos campos LastName e\xa0 FirstName\n\xa0\xa0// onde "LastName = Smith" e armazena-as em arrays $a_LastName e $a_FirstName\n\xa0\xa0\xa0\xa0SQL EXECUTE("SELECT LastName, FirstName FROM PERSONS WHERE LastName = ?";$a_LastName;$a_FirstName)\n\xa0\xa0\xa0\xa0If(Not(SQL End selection))\xa0// Se ao menos um registro for encontrado\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL LOAD RECORD(SQL all records)\xa0// Carrega todos os registros\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$UseSQL:=True\xa0// Escolhe o modo para integrar os dados (s\xf3 demo)\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If($UseSQL)\xa0// Usa SQL requests\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL LOGOUT\xa0// Log out do banco de dados remoto\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL LOGIN(SQL_INTERNAL;"user";"password")\xa0// Log in ao banco de dados local\n\xa0\xa0// A partir daqui todas as requisi\xe7\xf5es\xa0 SQL s\xe3o feitas no banco de dados local\xa0\n\xa0\xa0// Salva os arrays $a_LastName e $a_FirstName na tabela local PERSONS\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SQL EXECUTE("INSERT INTO PERSONS(LastName, FirstName) VALUES (:$a_LastName, :$a_FirstName);")\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\xa0// Usa 4D commands\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0For($i;1;Size of array($a_LastName))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0CREATE RECORD([PERSONS])\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[PERSONS]LastName:=$a_LastName{$i}\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[PERSONS]FirstName:=$a_FirstName{$i}\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SAVE RECORD([PERSONS])\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0End for\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0SQL LOGOUT\xa0// Fecha a conex\xe3o\n\xa0End if\n'})}),"\n",(0,s.jsx)(a.h4,{id:"vari\xe1veis-e-conjuntos-do-sistema",children:"Vari\xe1veis e conjuntos do sistema"}),"\n",(0,s.jsx)(a.p,{children:"Se o comando for executado corretamente, a vari\xe1vel sistema OK retorna 1, do contr\xe1rio retorna 0."}),"\n",(0,s.jsx)(a.h4,{id:"ver-tamb\xe9m",children:"Ver tamb\xe9m"}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.a,{href:"/docs/pt/next/commands/sql-load-record",children:"SQL LOAD RECORD"})})]})}function i(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,a,o)=>{o.d(a,{R:()=>d,x:()=>t});var s=o(296540);const n={},r=s.createContext(n);function d(e){const a=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),s.createElement(r.Provider,{value:a},e.children)}}}]);