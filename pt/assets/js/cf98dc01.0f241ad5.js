"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[11286],{3905:(e,o,r)=>{r.d(o,{Zo:()=>m,kt:()=>u});var a=r(67294);function t(e,o,r){return o in e?Object.defineProperty(e,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[o]=r,e}function n(e,o){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);o&&(a=a.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?n(Object(r),!0).forEach((function(o){t(e,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}))}return e}function s(e,o){if(null==e)return{};var r,a,t=function(e,o){if(null==e)return{};var r,a,t={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],o.indexOf(r)>=0||(t[r]=e[r]);return t}(e,o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var l=a.createContext({}),i=function(e){var o=a.useContext(l),r=o;return e&&(r="function"==typeof e?e(o):d(d({},o),e)),r},m=function(e){var o=i(e.components);return a.createElement(l.Provider,{value:o},e.children)},p={inlineCode:"code",wrapper:function(e){var o=e.children;return a.createElement(a.Fragment,{},o)}},c=a.forwardRef((function(e,o){var r=e.components,t=e.mdxType,n=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),c=i(r),u=t,g=c["".concat(l,".").concat(u)]||c[u]||p[u]||n;return r?a.createElement(g,d(d({ref:o},m),{},{components:r})):a.createElement(g,d({ref:o},m))}));function u(e,o){var r=arguments,t=o&&o.mdxType;if("string"==typeof e||t){var n=r.length,d=new Array(n);d[0]=c;var s={};for(var l in o)hasOwnProperty.call(o,l)&&(s[l]=o[l]);s.originalType=e,s.mdxType="string"==typeof e?e:t,d[1]=s;for(var i=2;i<n;i++)d[i]=r[i];return a.createElement.apply(null,d)}return a.createElement.apply(null,r)}c.displayName="MDXCreateElement"},33699:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>d,metadata:()=>l,toc:()=>m});r(67294);var a=r(3905);function t(){return t=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},t.apply(this,arguments)}function n(e,o){if(null==e)return{};var r,a,t=function(e,o){if(null==e)return{};var r,a,t={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],o.indexOf(r)>=0||(t[r]=e[r]);return t}(e,o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}const d={id:"error-handling",title:"Gest\xe3o de erros"},s=void 0,l={unversionedId:"Concepts/error-handling",id:"version-19-R8/Concepts/error-handling",title:"Gest\xe3o de erros",description:"O manejo de erros \xe9 o processo de antecipar e responder aos erros que possam ocorrer em sua aplica\xe7\xe3o. 4D oferece assist\xeancia completa \xe0 detec\xe7\xe3o e notifica\xe7\xe3o de erros no tempo de execu\xe7\xe3o, assim como a an\xe1lise de suas condi\xe7\xf5es.",source:"@site/i18n/pt/docusaurus-plugin-content-docs/version-19-R8/Concepts/error-handling.md",sourceDirName:"Concepts",slug:"/Concepts/error-handling",permalink:"/docs/pt/Concepts/error-handling",draft:!1,editUrl:"https://github.com/4D/docs/edit/main/versioned_docs/version-19-R8/Concepts/error-handling.md",tags:[],version:"19-R8",frontMatter:{id:"error-handling",title:"Gest\xe3o de erros"},sidebar:"docs",previous:{title:"Estruturas de loop",permalink:"/docs/pt/Concepts/looping"},next:{title:"Modos interpretado e compilado",permalink:"/docs/pt/Concepts/interpreted-compiled"}},i={},m=[{value:"Erro ou status",id:"erro-ou-status",level:2},{value:"Instala\xe7\xe3o de um m\xe9todo de gest\xe3o de erros",id:"instala\xe7\xe3o-de-um-m\xe9todo-de-gest\xe3o-de-erros",level:2},{value:"Alcance e componentes",id:"alcance-e-componentes",level:3},{value:"Manejo de erros dentro do m\xe9todo",id:"manejo-de-erros-dentro-do-m\xe9todo",level:3},{value:"Exemplo",id:"exemplo",level:4},{value:"Utilizar um m\xe9todo de gest\xe3o de erro vazio",id:"utilizar-um-m\xe9todo-de-gest\xe3o-de-erro-vazio",level:3}],p={toc:m};function c(e){var{components:o}=e,r=n(e,["components"]);return(0,a.kt)("wrapper",t({},p,r,{components:o,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"O manejo de erros \xe9 o processo de antecipar e responder aos erros que possam ocorrer em sua aplica\xe7\xe3o. 4D oferece assist\xeancia completa \xe0 detec\xe7\xe3o e notifica\xe7\xe3o de erros no tempo de execu\xe7\xe3o, assim como a an\xe1lise de suas condi\xe7\xf5es."),(0,a.kt)("p",null,"Manejo de erros responde \xe0 duas necessidades principais:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"descobrir e consertar erros potenciais e bugs no c\xf3digo durante a fase de desenvolvimento,"),(0,a.kt)("li",{parentName:"ul"},"detectar e recuperar de erros inesperados nas aplica\xe7\xf5es implementadas; em particular pode substituir di\xe1logos de erros de sistemas (disco cheio, arquivo faltando, etc) com sua pr\xf3pria interface.")),(0,a.kt)("p",null,":::dica Boa pr\xe1tica"),(0,a.kt)("p",null,"\xc9 altamente recomend\xe1vel instalar um m\xe9todo global de tratamento de erros no Servidor 4D, para todos os c\xf3digos em execu\xe7\xe3o no servidor. Este m\xe9todo evitaria caixas de di\xe1logo inesperadas a serem exibidas na m\xe1quina do servidor (se executado com interface), e poderia registar erros num arquivo dedicado para an\xe1lises posteriores."),(0,a.kt)("p",null,":::"),(0,a.kt)("h2",t({},{id:"erro-ou-status"}),"Erro ou status"),(0,a.kt)("p",null,"Muitas fun\xe7\xf5es de classe 4D, tais como ",(0,a.kt)("inlineCode",{parentName:"p"},"entity.save()")," ou ",(0,a.kt)("inlineCode",{parentName:"p"},"transporter.send()"),', devolvem um objecto com o estatuto **. Este objecto \xe9 utilizado para armazenar erros "previs\xedveis" no contexto do tempo de execu\xe7\xe3o, por exemplo, palavra-passe inv\xe1lida, entidade bloqueada, etc., que n\xe3o interrompem a execu\xe7\xe3o do programa. Esta categoria de erros pode ser tratada por c\xf3digo normal.'),(0,a.kt)("p",null,'Outros erros "imprevis\xedveis" incluem erro de grava\xe7\xe3o em disco, falha de rede, ou em geral qualquer interrup\xe7\xe3o inesperada. Esta categoria de erros gera exce\xe7\xf5es e precisa ser tratada atrav\xe9s de um m\xe9todo de tratamento de erros.'),(0,a.kt)("h2",t({},{id:"instala\xe7\xe3o-de-um-m\xe9todo-de-gest\xe3o-de-erros"}),"Instala\xe7\xe3o de um m\xe9todo de gest\xe3o de erros"),(0,a.kt)("p",null,"Em 4D, todos os erros podem ser apanhados e tratados por m\xe9todos de projecto espec\xedficos, denominados ",(0,a.kt)("strong",{parentName:"p"},"manipula\xe7\xe3o de erros")," (ou ",(0,a.kt)("strong",{parentName:"p"},"captura de erros"),") m\xe9todos."),(0,a.kt)("p",null,"Uma vez instalados, os manipuladores de erros s\xe3o automaticamente chamados em modo interpretado ou compilado em caso de erro na aplica\xe7\xe3o 4D ou num dos seus componentes. Um manipulador de erros diferente pode ser chamado em fun\xe7\xe3o do contexto de execu\xe7\xe3o (ver abaixo)."),(0,a.kt)("p",null,"Para ",(0,a.kt)("em",{parentName:"p"},"instalar")," um m\xe9todo de projecto de tratamento de erros, basta chamar o comando ",(0,a.kt)("a",t({parentName:"p"},{href:"https://doc.4d.com/4dv19/help/command/en/page155.html"}),(0,a.kt)("inlineCode",{parentName:"a"},"ON ERR CALL"))," com o nome do m\xe9todo de projecto e (opcionalmente) o \xe2mbito como par\xe2metros. Por exemplo:"),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("IO_Errors";ek local) //Instala um m\xe9todo local de tratamento de erros\n')),(0,a.kt)("p",null,"Para parar de apanhar erros para um contexto de execu\xe7\xe3o e devolver a m\xe3o, contactar ",(0,a.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," com uma cadeia vazia:"),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("";ek local) // d\xe1 o controle para o processo local\n')),(0,a.kt)("p",null,"O comando  ",(0,a.kt)("a",t({parentName:"p"},{href:"https://doc.4d.com/4dv19/help/command/en/page704.html"}),(0,a.kt)("inlineCode",{parentName:"a"},"M\xe9todo chamado por erro"))," permite saber o nome do m\xe9todo instalado por ",(0,a.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," para o processo atual. \xc9 particularmente \xfatil no contexto do c\xf3digo gen\xe9rico porque permite alterar temporariamente e depois restaurar o m\xe9todo de captura de erros:"),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),' $methCurrent:=M\xe9todo chamado por erro(ek local)\n ON ERR CALL("NewMethod";ek local)\n  //Se o documento n\xe3o puder ser aberto, \xe9 gerado um erro\n $ref:=Open document("MyDocument")\n  //Reinstala\xe7\xe3o do m\xe9todo anterior\n ON ERR CALL($methCurrent;ek local)\n\n')),(0,a.kt)("h3",t({},{id:"alcance-e-componentes"}),"Alcance e componentes"),(0,a.kt)("p",null,"Um m\xe9todo de tratamento de erros pode ser definido para diferentes contextos de execu\xe7\xe3o:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"para o processo atual ****- um gerenciador de erros local s\xf3 ser\xe1 chamado para erros que tenham ocorrido no processo actual,"),(0,a.kt)("li",{parentName:"ul"},"para toda a aplica\xe7\xe3o ****- um gerenciador de erros global ser\xe1 chamado para todos os erros que ocorreram no contexto da execu\xe7\xe3o da aplica\xe7\xe3o,"),(0,a.kt)("li",{parentName:"ul"},"para os componentes ****- ser\xe1 chamada no anfitri\xe3o para todos os erros que ocorreram nos componentes.")),(0,a.kt)("p",null,"Exemplos:"),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("IO_Errors";ek local) //Instala um m\xe9todo local de tratamento de erros\nON ERR CALL("globalHandler";ek global) //Instala um m\xe9todo global de tratamento de erros\nON ERR CALL("componentHandler";ek erros de componentes) //Instala um m\xe9todo de tratamento de erros de componentes\n')),(0,a.kt)("p",null,'Pode instalar um gerenciador de erros global que servir\xe1 como "fallback" e m\xe9todos de erros locais espec\xedficos para certos processos. Um manipulador de erros global \xe9 tamb\xe9m \xfatil no servidor para evitar di\xe1logos de erro no servidor quando executado com interface.'),(0,a.kt)("p",null,"Pode definir um \xfanico m\xe9todo de captura de erros para toda a aplica\xe7\xe3o ou diferentes m\xe9todos por m\xf3dulo de aplica\xe7\xe3o. No entanto, apenas um m\xe9todo pode ser instalado por contexto de execu\xe7\xe3o."),(0,a.kt)("p",null,'Quando ocorre um erro, apenas um m\xe9todo \xe9 chamado, mesmo que sejam instalados v\xe1rios manipuladores de erros "simult\xe2neos":'),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"se o erro ocorrer no processo actual, o manipulador local \xe9 chamado e N\xc3O o manipulador global;"),(0,a.kt)("li",{parentName:"ul"},'se o erro ocorrer num componente e o componente tiver o seu pr\xf3prio manipulador de erros, o manipulador de erros do componente \xe9 chamado e N\xc3O o manipulador de "erros de componentes" da aplica\xe7\xe3o anfitri\xe3.')),(0,a.kt)("h3",t({},{id:"manejo-de-erros-dentro-do-m\xe9todo"}),"Manejo de erros dentro do m\xe9todo"),(0,a.kt)("p",null,"Dentro de um m\xe9todo de erro personalizado, tem acesso a v\xe1rias pe\xe7as de informa\xe7\xe3o que o ajudar\xe3o a identificar o erro:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"vari\xe1veis do sistema dedicado:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Error")," (inteiro longo): c\xf3digo de erro"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Error method"),"(texto): nome do m\xe9todo que provocou o erro"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Error line")," (entero largo): n\xfamero de l\xednea do m\xe9todo que provocou o erro"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Error formula")," (text): f\xf3rmula do c\xf3digo 4D (texto bruto) que est\xe1 na origem do erro.")))),(0,a.kt)("admonition",t({},{type:"info"}),(0,a.kt)("p",{parentName:"admonition"},"4D mant\xe9m automaticamente uma s\xe9rie de vari\xe1veis chamadas ",(0,a.kt)("strong",{parentName:"p"},"vari\xe1veis de sistema"),", satisfazendo diferentes necessidades. Ver o manual de refer\xeancia de l\xednguas ",(0,a.kt)("em",{parentName:"p"},"4D"),".")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"o comando ",(0,a.kt)("a",t({parentName:"li"},{href:"https://doc.4d.com/4dv19/help/command/en/page1799.html"}),(0,a.kt)("inlineCode",{parentName:"a"},"\xfaltimos erros"))," que devolve uma cole\xe7\xe3o da pilha actual de erros que ocorreram na aplica\xe7\xe3o 4D. Tamb\xe9m pode usar o comando ",(0,a.kt)("a",t({parentName:"li"},{href:"https://doc.4d.com/4dv19/help/command/en/page1015.html"}),(0,a.kt)("inlineCode",{parentName:"a"},"GET LAST ERROR STACK"))," que devolve a mesma informa\xe7\xe3o que os arrays."),(0,a.kt)("li",{parentName:"ul"},"o comando ",(0,a.kt)("inlineCode",{parentName:"li"},"Get call chain")," que devolve uma cole\xe7\xe3o de objetos que descrevem cada passo da string de chamadas a m\xe9todos dentro do processo atual.")),(0,a.kt)("h4",t({},{id:"exemplo"}),"Exemplo"),(0,a.kt)("p",null,"Aqui est\xe1 um sistema de gest\xe3o de erros simples:"),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),'//instalar o m\xe9todo de gest\xe3o de erros\n ON ERR CALL("errorMethod")\n //... executar o c\xf3digo\n ON ERR CALL("") //retorna o controle para 4D\n')),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),'// m\xe9todo projeto errorMethod\n If(Error#1006) //essa n\xe3o \xe9 uma interrup\xe7\xe3o do usu\xe1rio\n    ALERT("Um erro foi produzido "+String(Error)+". O c\xf3digo em quest\xe3o \xe9: \\""+Error formula+"\\"")\n End if\n')),(0,a.kt)("h3",t({},{id:"utilizar-um-m\xe9todo-de-gest\xe3o-de-erro-vazio"}),"Utilizar um m\xe9todo de gest\xe3o de erro vazio"),(0,a.kt)("p",null,"Se quiser que a caixa de di\xe1logo fique escondida, pode instalar um m\xe9todo de gest\xe3o de erros vazio. A vari\xe1vel sistema ",(0,a.kt)("inlineCode",{parentName:"p"},"Error")," pode ser provada em qualquer m\xe9todo, ou seja, fora do m\xe9todo de gest\xe3o de erros:"),(0,a.kt)("pre",null,(0,a.kt)("code",t({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("emptyMethod") //emptyMethod exists but is empty\n$doc:=Open document( "myFile.txt")\nIf (Error=-43)\n    ALERT("File not found.")\nEnd if\nON ERR CALL("")\n')))}c.isMDXComponent=!0}}]);