<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-19-R6 plugin-docs plugin-id-default docs-doc-id-API/IMAPTransporterClass">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="4D Docs" href="/docs/fr/opensearch.xml"><title data-rh="true">IMAPTransporter | 4D Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://doc4d.github.io//docs/fr/../assets/en/logohome.png"><meta data-rh="true" name="twitter:image" content="https://doc4d.github.io//docs/fr/../assets/en/logohome.png"><meta data-rh="true" property="og:url" content="https://doc4d.github.io//docs/fr/API/IMAPTransporterClass"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="19-R6"><meta data-rh="true" name="docusaurus_tag" content="docs-default-19-R6"><meta data-rh="true" name="docsearch:version" content="19-R6"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-19-R6"><meta data-rh="true" property="og:title" content="IMAPTransporter | 4D Docs"><meta data-rh="true" name="description" content="La classe IMAPTransporter vous permet de récupérer des messages à partir d&#x27;un serveur de messagerie IMAP."><meta data-rh="true" property="og:description" content="La classe IMAPTransporter vous permet de récupérer des messages à partir d&#x27;un serveur de messagerie IMAP."><link data-rh="true" rel="icon" href="/docs/fr/img/favicon/4d.gif"><link data-rh="true" rel="canonical" href="https://doc4d.github.io//docs/fr/API/IMAPTransporterClass"><link data-rh="true" rel="alternate" href="https://doc4d.github.io//docs/API/IMAPTransporterClass" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc4d.github.io//docs/fr/API/IMAPTransporterClass" hreflang="fr"><link data-rh="true" rel="alternate" href="https://doc4d.github.io//docs/es/API/IMAPTransporterClass" hreflang="es"><link data-rh="true" rel="alternate" href="https://doc4d.github.io//docs/ja/API/IMAPTransporterClass" hreflang="ja"><link data-rh="true" rel="alternate" href="https://doc4d.github.io//docs/pt/API/IMAPTransporterClass" hreflang="pt"><link data-rh="true" rel="alternate" href="https://doc4d.github.io//docs/API/IMAPTransporterClass" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YOUR_APP_ID-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/docs/fr/assets/css/styles.3525c557.css">
<link rel="preload" href="/docs/fr/assets/js/runtime~main.67d1bd84.js" as="script">
<link rel="preload" href="/docs/fr/assets/js/main.b3efc654.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/fr/"><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/fr/GettingStarted/installation">v19 R6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/fr/next/API/IMAPTransporterClass">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/fr/API/IMAPTransporterClass">v19 R6</a></li><li><a class="dropdown__link" href="/docs/fr/19/API/IMAPTransporterClass">v19</a></li><li><a class="dropdown__link" href="/docs/fr/18/GettingStarted/installation">v18</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Français</a><ul class="dropdown__menu"><li><a href="/docs/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/docs/fr/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">Français</a></li><li><a href="/docs/es/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link">Español</a></li><li><a href="/docs/ja/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/docs/pt/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link">Português</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/GettingStarted/installation">Prise en main</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/fr/Project/overview">Core Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Project/overview">Project Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Concepts/about">4D Language Concepts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://doc.4d.com/4Dv19R6/4D/19-R6/4D-Language-Reference.100-5910320.en.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">4D Language Reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/ORDA/overview">ORDA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/fr/API/overview">Class API Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/overview">Aperçu - API des classes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/BlobClass">Blob</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ClassClass">Classe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/CollectionClass">Collections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/CryptoKeyClass">CryptoKey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/DataClassClass">DataClass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/DataClassAttributeClass">DataClassAttribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/DataStoreClass">DataStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/EmailObjectClass">Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/EntityClass">Entité (entity)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/EntitySelectionClass">EntitySelection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FileClass">File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FolderClass">Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FunctionClass">Formula</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/HTTPRequestClass">HTTPRequest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/fr/API/IMAPTransporterClass">IMAPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/MailAttachmentClass">MailAttachment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/POP3TransporterClass">POP3Transporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SessionClass">Session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SignalClass">Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SMTPTransporterClass">SMTPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SystemWorkerClass">SystemWorker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebServerClass">WebServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ZipArchiveClass">ZIPArchive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ZipFileClass">ZIPFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ZipFolderClass">ZIPFolder</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/code-editor/overview">Handling Code</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Debugging/basics">Debugging</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/settings/overview">Settings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Preferences/overview">Preferences</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/ServerWindow/overview">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/Extensions/overview">Extensions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/WebServer/overview">Web Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/Desktop/clientServer">Desktop Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://developer.4d.com/go-mobile/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Mobile Applications</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/fr/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Class API Reference</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">IMAPTransporter</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v19 R6</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p>La classe <code>IMAPTransporter</code> vous permet de récupérer des messages à partir d&#x27;un serveur de messagerie IMAP.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objet-imap-transporter">Objet IMAP Transporter<a class="hash-link" href="#objet-imap-transporter" title="Direct link to heading">​</a></h3><p>Les objets IMAP Transporter sont instanciés avec la commande <a href="#imap-new-transporter">IMAP New transporter</a>. Leurs propriétés et fonctions sont les suivantes :</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a> <!-- --> <!-- --> <!-- --> <strong>True</strong> if 4D is allowed to establish an unencrypted connection</td></tr><tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->adds flags to the <code>msgIDs</code> for the specified <code>keywords</code></td></tr><tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->appends a <code>mailObj</code> to the <code>destinationBox</code></td></tr><tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->the authentication mode used to open the session on the mail server</td></tr><tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a> <!-- --> <!-- --> <!-- --> <!-- --> checks the connection using information stored in the transporter object</td></tr><tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->the maximum time (in seconds) allowed prior to checking the connection to the server</td></tr><tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->the maximum wait time (in seconds) allowed to establish a connection to the server</td></tr><tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->The <code>.getMails()</code> function</td></tr><tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->creates a mailbox with the given <code>name</code></td></tr><tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->The <code>.removeFlags()</code> function</td></tr><tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->permanently removes the mailbox with the given <code>name</code> from the IMAP server</td></tr><tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->removes all messages with the &quot;deleted&quot; flag from the IMAP mail server.</td></tr><tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a <code>boxInfo</code> object corresponding to the current maibox, or the mailbox <em>name</em></td></tr><tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a collection of mailboxes describing all of the available mailboxes</td></tr><tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the character used to delimit levels of hierarchy in the mailbox name</td></tr><tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr><tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr><tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a> <!-- --> <!-- --> <!-- --> <!-- -->copies the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server</td></tr><tr><td><a href="#host"><strong>.host</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->the name or the IP address of the host server</td></tr><tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->the path of the extended log file defined (if any) for the mail connection</td></tr><tr><td><a href="#move"><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server</td></tr><tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em></td></tr><tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->sets the &quot;deleted&quot; flag for the messages defined in <code>msgsIDs</code> or <code>allMsgs</code></td></tr><tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->changes the name of a mailbox on the IMAP server</td></tr><tr><td><a href="#port"><strong>.port</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- --> the port number used for mail transactions</td></tr><tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->searches for messages that match the given <em>searchCriteria</em> in the current mailbox</td></tr><tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->selects the <em>name</em> mailbox as the current mailbox</td></tr><tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes</td></tr><tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->removes a mailbox from a set of subscribed mailboxes</td></tr><tr><td><a href="#user"><strong>.user</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- --> the user name used for authentication on the mail server</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="imap-new-transporter">IMAP New transporter<a class="hash-link" href="#imap-new-transporter" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td align="center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Result</td><td>4D.IMAPTransporter</td><td align="center">&lt;-</td><td><a href="#imap-transporter-object">IMAP transporter object</a></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a class="hash-link" href="#description" title="Direct link to heading">​</a></h4><p>The <code>IMAP New transporter</code> command configures a new IMAP connection according to the <em>server</em> parameter and returns a new <em>transporter</em> object. L&#x27;objet transporteur retourné sera alors utilisé pour la réception d&#x27;emails.</p><p>Dans le paramètre <em>server</em>, passez un objet contenant les propriétés suivantes :</p><table><thead><tr><th><em>server</em></th><th>Valeur par défaut (si omise)</th></tr></thead><tbody><tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a> <!-- --> <!-- --> <!-- --> <strong>True</strong> if 4D is allowed to establish an unencrypted connection</td><td>False</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br>.<strong>accessTokenOAuth2</strong>: Object<br>Text string or token object representing OAuth2 authorization credentials. Il est utilisé uniquement avec OAUTH2 <code>authenticationMode</code>. Si <code>accessTokenOAuth2</code> est utilisé mais que <code>authenticationMode</code> est omis, le protocole OAuth 2 est utilisé (si le serveur l&#x27;autorise). Non retourné en objet <em><a href="#imap-transporter-object">IMAP transporter</a></em>.</td><td>aucun</td></tr><tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->the authentication mode used to open the session on the mail server</td><td>le mode d&#x27;authentification le plus sûr pris en charge par le serveur est utilisé</td></tr><tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->the maximum time (in seconds) allowed prior to checking the connection to the server</td><td>300</td></tr><tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->the maximum wait time (in seconds) allowed to establish a connection to the server</td><td>30</td></tr><tr><td><a href="#host"><strong>.host</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->the name or the IP address of the host server</td><td><em>obligatoire</em></td></tr><tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->the path of the extended log file defined (if any) for the mail connection</td><td>aucun</td></tr><tr><td>.<strong>password</strong> : Text<br>User password for authentication on the server. Non retourné en objet <em><a href="#imap-transporter-object">IMAP transporter</a></em>.</td><td>aucun</td></tr><tr><td><a href="#port"><strong>.port</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- --> the port number used for mail transactions</td><td>993</td></tr><tr><td><a href="#user"><strong>.user</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- --> the user name used for authentication on the mail server</td><td>aucun</td></tr></tbody></table><blockquote><p><strong>Attention</strong> : Assurez-vous que le timeout défini est inférieur au timeout du serveur, sinon le timeout du client sera inutile.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result">Result<a class="hash-link" href="#result" title="Direct link to heading">​</a></h4><p>La fonction retourne un <a href="#imap-transporter-object"><strong>objet IMAP transporter</strong></a>. Toutes les propriétés retournées sont en <strong>lecture seule</strong>.</p><blockquote><p>La connexion IMAP est automatiquement fermée lorsque l&#x27;objet transporteur est détruit.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple">Exemple<a class="hash-link" href="#exemple" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$server.logFile:=&quot;LogTest.txt&quot; //log à sauvegarder dans le dossier Logs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.checkConnection()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(Not($status.success))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;An error occurred: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4dimaptransporternew">4D.IMAPTransporter.new()<a class="hash-link" href="#4dimaptransporternew" title="Direct link to heading">​</a></h2><p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td align="center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Result</td><td>4D.IMAPTransporter</td><td align="center">&lt;-</td><td><a href="#imap-transporter-object">IMAP transporter object</a></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-1">Description<a class="hash-link" href="#description-1" title="Direct link to heading">​</a></h4><p>The <code>4D.IMAPTransporter.new()</code> function creates and returns a new object of the <code>4D.IMAPTransporter</code> type. .</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="acceptunsecureconnection">.acceptUnsecureConnection<a class="hash-link" href="#acceptunsecureconnection" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-2">Description<a class="hash-link" href="#description-2" title="Direct link to heading">​</a></h4><p>The <code>.acceptUnsecureConnection</code> property contains <strong>True</strong> if 4D is allowed to establish an unencrypted connection when encrypted connection is not possible.</p><p>Elle contient <strong>False</strong> si les connexions non chiffrées ne sont pas autorisées, auquel cas une erreur est retournée lorsque la connexion chiffrée n&#x27;est pas possible.</p><p>Ports sécurisés disponibles :</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 ou 25 : SMTP avec mise à niveau STARTTLS si le serveur le prend en charge.</li></ul></li><li><p>IMAP</p><ul><li>143 : Port IMAP non chiffré</li><li>993 : IMAP avec mise à niveau STARTTLS si le serveur le prend en charge</li></ul></li><li><p>POP3</p><ul><li>110 : Port POP3 non chiffré</li><li>995 : POP3 avec mise à niveau STARTTLS si le serveur le prend en charge.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="addflags">.addFlags()<a class="hash-link" href="#addflags" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collections</td><td align="center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d&#x27;un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée</td></tr><tr><td>keywords</td><td>Object</td><td align="center">-&gt;</td><td>Mots-clés de flags à ajouter</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération addFlags</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-3">Description<a class="hash-link" href="#description-3" title="Direct link to heading">​</a></h4><p>The <code>.addFlags()</code> function adds flags to the <code>msgIDs</code> for the specified <code>keywords</code>.</p><p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit :</p><ul><li><p>une <em>collection</em> contenant les IDs uniques de messages spécifiques, ou</p></li><li><p>l&#x27;ID unique (<em>texte</em>) d&#x27;un seul message ou</p></li><li><p>la constante suivante (<em>entier long</em>) pour tous les messages de la boîte sélectionnée :</p><table><thead><tr><th>Constante</th><th>Value</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr></tbody></table></li></ul><p>Le paramètre <code>keywords</code> vous permet de passer un objet avec des valeurs de mots-clés pour les flags spécifiques à ajouter à <code>msgIDs</code>. Vous pouvez utiliser les mots-clés suivants :</p><table><thead><tr><th>Paramètres</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;draft&quot; au message</td></tr><tr><td>$seen</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;seen&quot; au message</td></tr><tr><td>$flagged</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;flagged&quot; au message</td></tr><tr><td>$answered</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;répondu&quot; au message</td></tr><tr><td>$deleted</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;supprimé&quot; au message</td></tr></tbody></table><blockquote><ul><li>Les valeurs à faux sont ignorées.</li><li>L&#x27;interprétation des indicateurs de mots-clés peut varier selon le client de messagerie.</li></ul></blockquote><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1">Exemple<a class="hash-link" href="#exemple-1" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Créer transporteur</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Sélectionner la boîte de messagerie</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Marquer tous les messages de la boite de réception (INBOX) comme étant lus/vus</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$flags:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$flags[&quot;$seen&quot;]:=True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="append">.append()<a class="hash-link" href="#append" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>mailObj</td><td>Object</td><td align="center">-&gt;</td><td>Objet email</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Mailbox devant recevoir l&#x27;objet email</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Objet contenant les informations de charset</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-4">Description<a class="hash-link" href="#description-4" title="Direct link to heading">​</a></h4><p>The <code>.append()</code> function appends a <code>mailObj</code> to the <code>destinationBox</code>.</p><p>Dans le paramètre <code>mailObj</code>, passez un objet email. Dans le paramètre <code>mailObj</code>, passez un objet email. La fonction <code>.append()</code> prend en charge les marqueurs de mots-clés dans l&#x27;attribut <code>keywords</code> des objets email.</p><p>Le paramètre optionnel <code>destinationBox</code> vous permet de passer le nom de la boîte de réception dans laquelle l&#x27;objet <code>mailObj</code> sera ajouté. S&#x27;il est omis, la mailbox courante sera utilisée.</p><p>Dans le paramètre optionnel <code>options</code>, vous pouvez passer un objet permettant de définir le charset et l&#x27;encodage des différentes parties de l&#x27;email. Propriétés disponibles :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset et encodage utilisés pour les parties de mail suivantes : le sujet, les noms de fichiers joints et le nom du mail. Valeurs possibles : voir le tableau des charsets possibles</td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset et encodage utilisés pour le contenu html et le texte du body du mail. Valeurs possibles : voir le tableau des charsets possibles</td></tr></tbody></table><p>Charsets possibles :</p><table><thead><tr><th>Constante</th><th>Value</th><th>Commentaire</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset : US-ASCII si possible, japonais (ISO-2022-JP) &amp; Quoted-printable si possible, sinon UTF-8 &amp; Quoted-printable</li><li>bodyCharset : US-ASCII si possible, japonais (ISO-2022-JP) et 7 bits si possible, sinon UTF-8 et Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinon UTF-8 &amp; Quoted-printable (<strong>valeur par défaut</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinon UTF-8 &amp; base64</td></tr></tbody></table><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2">Exemple<a class="hash-link" href="#exemple-2" title="Direct link to heading">​</a></h4><p>Pour enregistrer un email dans la boîte Drafts :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$settings:=New object(&quot;host&quot;; &quot;domain.com&quot;; &quot;user&quot;; &quot;xxxx&quot;; &quot;password&quot;; &quot;xxxx&quot;; &quot;port&quot;; 993)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg.from:=&quot;xxxx@domain.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg.subject:=&quot;Lorem Ipsum&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg.textBody:=&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg.keywords:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg.keywords[&quot;$seen&quot;]:=True//marquer le message comme étant lu</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$msg.keywords[&quot;$draft&quot;]:=True//marquer le message comme brouillon</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$imap.append($msg; &quot;Drafts&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="authenticationmode">.authenticationMode<a class="hash-link" href="#authenticationmode" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.authenticationMode</strong> : Text</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-5">Description<a class="hash-link" href="#description-5" title="Direct link to heading">​</a></h4><p>The <code>.authenticationMode</code> property contains the authentication mode used to open the session on the mail server.</p><p>Par défaut, le mode le plus sécurisé pris en charge par le serveur est utilisé.</p><p>Valeurs possibles :</p><table><thead><tr><th>Value</th><th>Constantes</th><th>Commentaire</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Authentification à l&#x27;aide du protocole CRAM-MD5</td></tr><tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Authentification à l&#x27;aide du protocole LOGIN</td></tr><tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Authentification à l&#x27;aide du protocole OAuth2</td></tr><tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Authentification à l&#x27;aide du protocole PLAIN</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="checkconnection">.checkConnection()<a class="hash-link" href="#checkconnection" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Statut de la connexion de l&#x27;objet transporteur</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-6">Description<a class="hash-link" href="#description-6" title="Direct link to heading">​</a></h4><p>The <code>.checkConnection()</code> function  checks the connection using information stored in the transporter object, recreates the connection if necessary, and returns the status. Cette fonction vous permet de vérifier que les valeurs fournies par l&#x27;utilisateur sont valides et cohérentes.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="objet-retourné">Objet retourné<a class="hash-link" href="#objet-retourné" title="Direct link to heading">​</a></h4><p>La fonction envoie une requête au serveur de mail et retourne un objet décrivant le statut. Cet objet peut avoir les propriétés suivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>Vrai si la vérification a été effectuée avec succès, sinon Faux</td></tr><tr><td>status</td><td></td><td>number</td><td>(SMTP uniquement) Code du statut retourné par le serveur de messagerie (0 en cas de problème non lié au traitement du mail)</td></tr><tr><td>statusText</td><td></td><td>text</td><td>Message du statut retourné par le serveur de messagerie, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur de messagerie est reçue)</td></tr><tr><td></td><td>[<!-- --> ].errCode</td><td>number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- --> ].message</td><td>text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- --> ].componentSignature</td><td>text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="checkconnectiondelay">.checkConnectionDelay<a class="hash-link" href="#checkconnectiondelay" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.checkConnectionDelay</strong> : Integer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-7">Description<a class="hash-link" href="#description-7" title="Direct link to heading">​</a></h4><p>The <code>.checkConnectionDelay</code> property contains the maximum time (in seconds) allowed prior to checking the connection to the server.  Si cette durée est dépassée entre deux appels de méthodes, la connexion au serveur sera vérifiée. Par défaut, si la propriété n&#x27;a pas été définie dans l&#x27;objet <em>server</em>, la valeur est de 300.</p><blockquote><p><strong>Attention</strong> : Assurez-vous que le timeout défini est inférieur au timeout du serveur, sinon le timeout du client sera inutile.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connectiontimeout">.connectionTimeOut<a class="hash-link" href="#connectiontimeout" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-8">Description<a class="hash-link" href="#description-8" title="Direct link to heading">​</a></h4><p>The <code>.connectionTimeOut</code> property contains the maximum wait time (in seconds) allowed to establish a connection to the server. Par défaut, si la propriété n&#x27;a pas été définie dans l&#x27;objet server (utilisé pour créer l&#x27;objet transporteur avec <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), la valeur utilisée est 30.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="copy">.copy()<a class="hash-link" href="#copy" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collections</td><td align="center">-&gt;</td><td>Collection d&#x27;IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Boîte de réception recevant les messages copiés</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération de copie</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-9">Description<a class="hash-link" href="#description-9" title="Direct link to heading">​</a></h4><p>The <code>.copy()</code> function The <code>.getMails()</code> function.</p><p>Vous pouvez passer :</p><ul><li>dans le paramètre <em>msgsIDs</em>, une collection contenant les ID uniques des messages spécifiques à copier, ou</li><li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAP all</code> (integer) pour copier tous les messages de la boîte de réception sélectionnée.</li></ul><p>Le paramètre <em>destinationBox</em> vous permet de passer une valeur texte avec le nom de la boîte de réception dans laquelle seront placés les messages copiés.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-1">Exemple 1<a class="hash-link" href="#exemple-1-1" title="Direct link to heading">​</a></h4><p>Pour copier une sélection de messages :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //obtenir la collection des IDs uniques de message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;4D new feature:\&quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // copier les messages identifiés dans la boîte de réception &quot;documents&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.copy($mailIds;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3">Exemple 3<a class="hash-link" href="#exemple-3" title="Direct link to heading">​</a></h4><p>Pour copier tous les messages de la boîte de réception courante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // copier les messages dans la boîte de réception &quot;documents&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.copy(IMAP all;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="createbox">.createBox()<a class="hash-link" href="#createbox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la nouvelle mailbox</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the mailbox creation operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-10">Description<a class="hash-link" href="#description-10" title="Direct link to heading">​</a></h4><p>The <code>.createBox()</code> function creates a mailbox with the given <code>name</code>. Si le caractère séparateur de hiérarchie du serveur IMAP apparaît dans le nom de la mailbox, le serveur IMAP créera tous les boîtes parentes nécessaires pour créer la boîte donnée.</p><p>Par exemple, si vous essayez de créer &quot;Projects/IMAP/Doc&quot; dans un serveur dont le &quot;/&quot; est le caractère séparateur de hiérarchie, les éléments suivants seront créés :</p><ul><li>Uniquement la boîte &quot;Doc&quot; si &quot;Projects&quot; &amp; &quot;IMAP&quot; existent déjà.</li><li>Les boîtes &quot;IMAP&quot; &amp; &quot;Doc&quot; si seule “Projects” existe déjà.</li><li>Les boîtes &quot;Projects&quot; &amp; “IMAP” &amp; &quot;Doc&quot; si elles n&#x27;existent pas déjà.</li></ul><p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à créer.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-4">Exemple<a class="hash-link" href="#exemple-4" title="Direct link to heading">​</a></h4><p>Pour créer une nouvelle boîte “Invoices” :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $server,$boxInfo,$result : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  If($boxInfo.mailCount&gt;0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     New object(&quot;withBody&quot;;False;&quot;updateSeen&quot;;False))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    For each($mail;$result.list)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End for each</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="delete">.delete()<a class="hash-link" href="#delete" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collections</td><td align="center">-&gt;</td><td>Collection d&#x27;IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the delete operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-11">Description<a class="hash-link" href="#description-11" title="Direct link to heading">​</a></h4><p>The <code>.delete()</code> function The <code>.removeFlags()</code> function.</p><p>Vous pouvez passer :</p><ul><li>dans le paramètre <code>msgsIDs</code>, une collection contenant les ID uniques des messages spécifiques à supprimer, ou</li><li>dans le paramètre <code>allMsgs</code>, la constante <code>IMAP all</code> (integer) pour supprimer tous les messages de la boîte de réception sélectionnée.</li></ul><p>L&#x27;exécution de cette fonction ne supprime pas réellement les messages. Les messages ayant le marqueur &quot;deleted&quot; peuvent toujours être trouvés par la fonction <a href="#searchmails">.searchMails()</a>. Les messages marqués sont supprimés du serveur IMAP uniquement avec <a href="#expunge"><code>.expunge()</code></a> ou en sélectionnant une autre boîte de réception ou lorsque l&#x27;objet <a href="#imap-transporter-object">transporter</a> (créé avec <a href="#imap-new-transporter">IMAP New transporter</a>) est détruit.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-2">Exemple 1<a class="hash-link" href="#exemple-1-2" title="Direct link to heading">​</a></h4><p>Pour supprimer une sélection de messages :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //obtenir la collection d&#x27;IDs unique des messages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;Reports\&quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // Supprimer les messages sélectionnés</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-1">Exemple 3<a class="hash-link" href="#exemple-3-1" title="Direct link to heading">​</a></h4><p>Pour supprimer tous les messages de la boîte de réception courante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //selection de la boîte</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Junk Email&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // suppression de tous les messages de la boîte courante</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.delete(IMAP all)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deletebox">.deleteBox()<a class="hash-link" href="#deletebox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception à supprimer</td></tr></tbody></table><p>|Result|Object|&lt;-|Status of the mailbox deletion operation|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-12">Description<a class="hash-link" href="#description-12" title="Direct link to heading">​</a></h4><p>The <code>.deleteBox()</code> function permanently removes the mailbox with the given <code>name</code> from the IMAP server. Si vous tentez de supprimer la boîte INBOX ou une boîte de réception qui n&#x27;existe pas, une erreur sera générée.</p><p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à supprimer.</p><blockquote><ul><li>La fonction ne peut pas supprimer une boîte de réception contenant des boîtes &quot;enfant&quot; si la boîte &quot;parente&quot; dispose de l&#x27;attribute &quot;\Noselect&quot;.</li><li>Tous les messages présents dans la boîte seront également supprimés.</li><li>La possibilité de supprimer une boîte de réception dépend du serveur de messagerie.</li></ul></blockquote><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-5">Exemple<a class="hash-link" href="#exemple-5" title="Direct link to heading">​</a></h4><p>Vous souhaitez supprimer la boîte enfant &quot;Nova Orion Industries&quot; à l&#x27;intérieur de la boîte &quot;Bills&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// delete mailbox</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Nova Orion Industries&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.deleteBox($name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ALERT(&quot;Mailbox deletion successful!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="expunge">.expunge()<a class="hash-link" href="#expunge" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.expunge()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the expunge operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-13">Description<a class="hash-link" href="#description-13" title="Direct link to heading">​</a></h4><p>The <code>.expunge()</code> function removes all messages with the &quot;deleted&quot; flag from the IMAP mail server. The &quot;deleted&quot; flag can be set with the <a href="#delete"><code>.delete()</code></a> or <a href="#addflags"><code>.addFlags()</code></a> methods.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-6">Exemple<a class="hash-link" href="#exemple-6" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $ids : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Creation du transporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Sélection de la boîte</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Chercher et sélectionner les messages lus dans INBOX</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ids:=$transporter.searchMails(&quot;SEEN&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Purger tous les messages marqués deleted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getboxinfo">.getBoxInfo()<a class="hash-link" href="#getboxinfo" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td><em>name</em> est optionnel</td></tr></tbody></table><p>|v18 R4|Added|</p></div></div></details><p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>boxInfo object</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-14">Description<a class="hash-link" href="#description-14" title="Direct link to heading">​</a></h4><p>The <code>.getBoxInfo()</code> function returns a <code>boxInfo</code> object corresponding to the current maibox, or the mailbox <em>name</em>. Cette fonction retourne les mêmes informations que <a href="#selectbox"><code>.selectBox()</code></a> mais sans modifier la boite de réception courante.</p><p>Dans le paramètre <em>name</em> passez le nom de la mailbox à laquelle vous souhaitez accéder. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. Le délimiteur peut être récupéré à l&#x27;aide de la fonction <a href="#getdelimiter"><code>.getDelimiter()</code></a>.</p><p>Si la boîte de réception nommée <em>name</em> n&#x27;est pas sélectionnable ou n&#x27;existe pas, la fonction génère une erreur et retourne <strong>null</strong>.</p><p><strong>Objet retourné</strong></p><p>L&#x27;objet <code>boxInfo</code> contient les propriété suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>text</td><td>Nom de la boîte de réception</td></tr><tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>mailRecent</td><td>number</td><td>Nombre de messages portant le marqueur &quot;récent&quot; (indiquant les nouveaux messages)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-7">Exemple<a class="hash-link" href="#exemple-7" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $info:=$transporter.getBoxInfo(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ALERT(&quot;INBOX contains &quot;+String($info.mailRecent)+&quot; recent emails.&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getboxlist">.getBoxList()<a class="hash-link" href="#getboxlist" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr><tr><td>v19</td><td>Ajout paramètre <code>isSubscribed</code></td></tr></tbody></table></div></div></details><p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>parameters</td><td>Object</td><td align="center">-&gt;</td><td>Objet de paramètre</td></tr><tr><td>Result</td><td>Collections</td><td align="center">&lt;-</td><td>Collection of mailbox objects</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-15">Description<a class="hash-link" href="#description-15" title="Direct link to heading">​</a></h4><p>The <code>.getBoxList()</code> function returns a collection of mailboxes describing all of the available mailboxes. Cette fonction vous permet de gérer localement les listes de messages situés sur le serveur de messagerie IMAP.</p><p>Dans le paramètre optionnel <code>parameters</code>, passez un objet contenant des valeurs de filtrage des boîtes de réception retournées. Vous pouvez passer :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>isSubscribed</td><td>Boolean</td><td><li><strong>True</strong> pour retourner uniquement les boîtes auxquelles vous êtes abonné</li><li> <strong>False</strong> pour retourner toutes les boîtes de réception disponibles</li></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result-1">Result<a class="hash-link" href="#result-1" title="Direct link to heading">​</a></h4><p>Chaque objet de la collection retournée contient les propriétés suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>[<!-- -->].name</td><td>text</td><td>Nom de la boîte de réception</td></tr><tr><td>[<!-- -->].selectable</td><td>boolean</td><td>Indique si les droits d&#x27;accès permettent ou non à la boite de réception d&#x27;être sélectionnée : <ul><li>vrai - la boite de réception peut être sélectionnée</li><li>faux - la boite de réception ne peut pas être sélectionnée</li></ul></td></tr><tr><td>[<!-- -->].inferior</td><td>boolean</td><td>Indique si les droits d&#x27;accès permettent ou non la création d&#x27;une hiérarchie inférieure dans la boite de réception : <ul><li>vrai - un niveau inférieur peut être créé</li><li>faux - un niveau inférieur ne peut pas être créé</li></ul></td></tr><tr><td>[<!-- -->].interesting</td><td>boolean</td><td>Indique si la boite de réception a été marquée comme &quot;intéressante&quot; par le serveur : <ul><li>vrai - la boite de réception a été marquée comme &quot;intéressante&quot; par le serveur. Par exemple, elle peut contenir de nouveaux messages.</li><li>faux - la boite de réception n&#x27;a pas été marquée comme &quot;intéressante&quot; par le serveur.</li></ul></td></tr></tbody></table><p>Si le compte ne contient pas de boites de réception, une collection vide est retournée.</p><blockquote><ul><li>Si aucune connexion n&#x27;est ouverte, <code>.getBoxList()</code> ouvrira une connexion.</li><li>Si la connexion n&#x27;a pas été utilisée depuis le délai de connexion (voir <code>IMAP New transporter</code>), la fonction <code>.checkConnection( )</code> est automatiquement appelée.</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-8">Exemple<a class="hash-link" href="#exemple-8" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> For each($box;$boxList)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    If($box.interesting)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End for each</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getdelimiter">.getDelimiter()<a class="hash-link" href="#getdelimiter" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.getDelimiter()</strong> : Text</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>Text</td><td align="center">&lt;-</td><td>Caractère de délimitation de hiérarchie</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-16">Description<a class="hash-link" href="#description-16" title="Direct link to heading">​</a></h4><p>The <code>.getDelimiter()</code> function returns the character used to delimit levels of hierarchy in the mailbox name.</p><p>Le délimiteur est un caractère pouvant être utilisé pour :</p><ul><li>créer des boites de réception de niveau inférieur</li><li>rechercher des niveaux inférieurs ou supérieurs dans la hiérarchie de la boite de réception</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result-2">Result<a class="hash-link" href="#result-2" title="Direct link to heading">​</a></h4><p>Caractère de délimitation des noms de boites de réception.</p><blockquote><ul><li>Si aucune connexion n&#x27;est ouverte, <code>.getDelimiter()</code> ouvrira une connexion.</li><li>Si la connexion n&#x27;a pas été utilisée depuis le <a href="#checkconnectiondelay">délai de connexion</a>, la fonction</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-9">Exemple<a class="hash-link" href="#exemple-9" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> For each($box;$boxList)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    If($box.interesting)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End for each</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getmail">.getMail()<a class="hash-link" href="#getmail" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du message</td></tr><tr><td>msgID</td><td>Text</td><td align="center">-&gt;</td><td>ID unique du message</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Instructions sur la gestion du message</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td><a href="/docs/fr/API/EmailObjectClass#email-object">Email object</a></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-17">Description<a class="hash-link" href="#description-17" title="Direct link to heading">​</a></h4><p>The <code>.getMail()</code> function returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>. Cette fonction vous permet de gérer localement le contenu de l&#x27;email.</p><p>Dans le premier paramètre, vous pouvez passer soit :</p><ul><li><em>msgNumber</em>, une valeur <em>integer</em> indiquant le numéro de séquence du message à récupérer ou</li><li><em>msgID</em>, une valeur <em>text</em> indiquant l&#x27;ID unique du message à récupérer.</li></ul><p>Le paramètre facultatif <em>options</em> vous permet de passer un objet définissant des instructions supplémentaires pour la gestion de votre message. Les propriétés suivantes sont disponibles :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updateSeen</td><td>boolean</td><td>Si Vrai, le message est marqué comme &quot;seen&quot; (lu) dans la boite de réception. Si Faux, le message n&#x27;est pas marqué comme &quot;seen&quot;. Valeur par défaut : Vrai</td></tr><tr><td>withBody</td><td>boolean</td><td>Passez Vrai pour retourner le corps du message. Si Faux, seul l&#x27;en-tête du message est retourné. Valeur par défaut : Vrai</td></tr></tbody></table><blockquote><ul><li>La fonction génère une erreur et retourne <strong>Null</strong> si <em>msgID</em> désigne un message non existant,</li><li>Si aucune boite de réception n&#x27;est sélectionnée avec la fonction <a href="#selectbox"><code>.selectBox()</code></a>, une erreur est générée,</li><li>Si aucune connexion n&#x27;est ouverte, <code>.getMail()</code> ouvrira une connexion avec la dernière boite de réception spécifiée par <a href="#selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result-3">Result<a class="hash-link" href="#result-3" title="Direct link to heading">​</a></h4><p><code>.getMail()</code> retourne un <a href="/docs/fr/API/EmailObjectClass#objet-email"><code>objet Email</code></a> avec les propriétés IMAP supplémentaires suivantes : <em>id</em>, <em>receivedAt</em> et <em>size</em>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-10">Exemple<a class="hash-link" href="#exemple-10" title="Direct link to heading">​</a></h4><p>Vous souhaitez lire le message avec ID = 1 :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //creation du transporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //selection de la mailbox</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //récupération de l&#x27;objet Email d&#x27;ID 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getmails">.getMails()<a class="hash-link" href="#getmails" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>ids</td><td>Collections</td><td align="center">-&gt;</td><td>Collection d&#x27;identifiants de messages</td></tr><tr><td>startMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du premier message</td></tr><tr><td>endMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Instructions sur la gestion du message</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Objet contenant :<br><ul><li>une collection d&#x27;<a href="/docs/fr/API/EmailObjectClass#objet-email">objets Email</a> et</li><li>une collection d&#x27;identifiants ou de numéros des messages manquants, le cas échéant</li></ul></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-18">Description<a class="hash-link" href="#description-18" title="Direct link to heading">​</a></h4><p>The <code>.getMIMEAsBlob()</code> function returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>.</p><p><strong>Première syntaxe :</strong></p><p><strong><em>.getMails( ids { ; options } ) -&gt; result</em></strong></p><p>La première syntaxe vous permet de récupérer des messages en fonction de leurs identifiants.</p><p>Dans le paramètre <em>ids</em>, passez une collection d&#x27;identifiants des messages à retourner. Vous pouvez obtenir les ID à l&#x27;aide de <a href="#getmail"><code>.getMail()</code></a>.</p><p>Le paramètre optionnel <em>options</em> vous permet de définir les parties de messages à retourner. Pour une description détaillée des propriétés disponibles, reportez-vous au tableau <strong>Options</strong> ci-dessous.</p><p><strong>Deuxième syntaxe :</strong></p><p> <strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</em></strong></p><p>La deuxième syntaxe vous permet de récupérer des messages en fonction d&#x27;une plage séquentielle. Les valeurs passées représentent la position des messages dans la boite de réception.</p><p>Dans le paramètre <em>startMsg</em>, passez une valeur integer correspondant au numéro du premier message dans la plage séquentielle. Si vous passez un nombre négatif (<em>startMsg</em> &lt;= 0), le premier message de la boîte de réception sera utilisé comme début de la séquence.</p><p>Dans le paramètre <em>endMsg</em>, passez une valeur integer correspondant au numéro du dernier message dans la plage séquentielle. Si vous passez un nombre négatif (<em>endMsg</em> &lt;= 0), le dernier message de la boîte de réception sera utilisé comme fin de séquence.</p><p>Le paramètre optionnel <em>options</em> vous permet de définir les parties de messages à retourner.</p><p><strong>Options</strong></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updateSeen</td><td>Boolean</td><td>Si Vrai, les messages sont marqués comme &quot;seen&quot; (lus) dans la boite de réception. Si Faux, les messages ne sont pas marqués comme &quot;seen&quot;. Valeur par défaut : Vrai</td></tr><tr><td>withBody</td><td>Boolean</td><td>Passez Vrai pour retourner le corps des messages spécifiés. Si Faux, seuls les en-tête des messages sont retournés. Valeur par défaut : Vrai</td></tr></tbody></table><blockquote><ul><li>Si aucune boite de réception n&#x27;est sélectionnée avec la fonction <a href="#selectbox"><code>.selectBox()</code></a>, une erreur est générée.</li><li>S&#x27;il n&#x27;y a pas de connexion ouverte, <code>.getMails()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l&#x27;aide de <a href="#selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result-4">Result<a class="hash-link" href="#result-4" title="Direct link to heading">​</a></h4><p><code>.getMails()</code> retourne un objet contenant les collections suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>liste</td><td>Collections</td><td>Collection d&#x27;objets <a href="/docs/fr/API/EmailObjectClass#email-object"><code>Email</code></a>. Si aucun objet Email n&#x27;est trouvé, une collection vide est retournée.</td></tr><tr><td>notFound</td><td>Collections</td><td>Collection de :<br><ul><li>première syntaxe - IDs de messages passés antérieurement qui n&#x27;existent pas</li><li>deuxième syntaxe - numéros de séquence des messages entre startMsg et endMsg qui n&#x27;existent pas</li></ul>Une collection vide est retournée si tous les messages sont trouvés.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-11">Exemple<a class="hash-link" href="#exemple-11" title="Direct link to heading">​</a></h4><p>Vous souhaitez récupérer les 20 emails les plus récents sans modifier le statut &quot;seen&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  If($boxInfo.mailCount&gt;0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     New object(&quot;withBody&quot;;False;&quot;updateSeen&quot;;False))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    For each($mail;$result.list)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    End for each</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getmimeasblob">.getMIMEAsBlob()<a class="hash-link" href="#getmimeasblob" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du message</td></tr><tr><td>msgID</td><td>Text</td><td align="center">-&gt;</td><td>ID unique du message</td></tr><tr><td>updateSeen</td><td>Boolean</td><td align="center">-&gt;</td><td>Si Vrai, le message est marqué comme &quot;seen&quot; (lu) dans la boite de réception. Si Faux, le message demeure inchangé.</td></tr><tr><td>Result</td><td>BLOB</td><td align="center">&lt;-</td><td>Blob of the MIME string returned from the mail server</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-19">Description<a class="hash-link" href="#description-19" title="Direct link to heading">​</a></h4><p>The <code>.copy()</code> function copies the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server.</p><p>Dans le premier paramètre, vous pouvez passer soit :</p><ul><li><em>msgNumber</em>, une valeur <em>integer</em> indiquant le numéro de séquence du message à récupérer ou</li><li><em>msgID</em>, une valeur <em>text</em> indiquant l&#x27;ID unique du message à récupérer.</li></ul><p>Le paramètre optionnel <em>updateSeen</em> vous permet d&#x27;indiquer si le message est marqué comme &quot;seen&quot; (lu) dans la boîte de réception. Vous pouvez passer :</p><ul><li><strong>Vrai</strong> - pour marquer le message comme &quot;seen&quot; (indiquant que le message a été lu)</li><li><strong>False</strong> - to leave the message&#x27;s &quot;seen&quot; status untouched &gt; <em> The function returns an empty BLOB if </em>msgNumber<em> or msgID</em> designates a non-existing message, &gt; <em> If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated, &gt; </em> If there is no open connection, <code>.getMIMEAsBlob()</code> will open a connection the last mailbox specified with <code>.selectBox()</code>.<blockquote><ul><li>La fonction retourne un BLOB vide si <em>msgNumber</em> ou msgID désigne un message inexistant,</li><li>Si aucune boite de réception n&#x27;est sélectionnée avec la fonction <a href="#selectbox"><code>.selectBox()</code></a>, une erreur est générée,</li><li>S&#x27;il n&#x27;y a pas de connexion ouverte,<code>.getMIMEAsBlob()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l&#x27;aide de <code>.selectBox()</code>.</li></ul></blockquote></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result-5">Result<a class="hash-link" href="#result-5" title="Direct link to heading">​</a></h4><p><code>.getMIMEAsBlob()</code> retourne un <code>BLOB</code> qui peut être archivé dans une base de données ou converti en un objet <a href="/docs/fr/API/EmailObjectClass#objet-email"><code>Email</code></a> avec la commande <code>MAIL Convert from MIME</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-12">Exemple<a class="hash-link" href="#exemple-12" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //obtenir la collection d&#x27;IDs uniques des messages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;4D new feature:\&quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // déplacer les messages de la boite de réception courante vers la boite de réception &quot;documents&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.move($mailIds;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="host">.host<a class="hash-link" href="#host" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.host</strong> : Text</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-20">Description<a class="hash-link" href="#description-20" title="Direct link to heading">​</a></h4><p>The <code>.host</code> property contains the name or the IP address of the host server. Utilisée pour les échanges de courrier (SMTP, POP3, IMAP).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logfile">.logFile<a class="hash-link" href="#logfile" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.logFile</strong> : Text</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-21">Description<a class="hash-link" href="#description-21" title="Direct link to heading">​</a></h4><p>The <code>.logFile</code> property contains the path of the extended log file defined (if any) for the mail connection. Elle peut être relative (au dossier Logs courant) ou absolue.</p><p>Contrairement aux fichiers log habituels (activés via la commande <code>SET DATABASE PARAMETER</code>), les fichiers log étendus stockent le contenu MIME de tous les emails envoyés et n&#x27;ont pas de limite de taille. Pour plus d&#x27;informations sur les fichiers log étendus, reportez-vous à :</p><ul><li><strong>Connexions SMTP</strong> - <a href="/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>Connexions POP3</strong> - <a href="/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>Connexions IMAP</strong> - <a href="/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="move">.move()<a class="hash-link" href="#move" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collections</td><td align="center">-&gt;</td><td>Collection d&#x27;IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Boîte de réception recevant les messages déplacés</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the move operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-22">Description<a class="hash-link" href="#description-22" title="Direct link to heading">​</a></h4><p>The <code>.move()</code> function moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server.</p><p>Vous pouvez passer :</p><ul><li>dans le paramètre <em>msgsIDs</em>, une collection contenant les ID uniques des messages spécifiques à déplacer, ou</li><li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAP all</code> (integer) pour déplacer tous les messages de la boîte de réception sélectionnée.</li></ul><p>Le paramètre <em>destinationBox</em> vous permet de passer une valeur texte avec le nom de la boîte de réception dans laquelle seront placés les messages déplacés.</p><blockquote><p>Cette fonction est uniquement prise en charge par les serveurs IMAP compatibles avec RFC <a href="https://tools.ietf.org/html/rfc8474" target="_blank" rel="noopener noreferrer">8474</a>.</p></blockquote><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-3">Exemple 1<a class="hash-link" href="#exemple-1-3" title="Direct link to heading">​</a></h4><p>Pour déplacer une sélection de messages :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // déplacer tous les messages de la boite de réception courante vers la boite de réception &quot;documents&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.move(IMAP all;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-2">Exemple 3<a class="hash-link" href="#exemple-3-2" title="Direct link to heading">​</a></h4><p>Pour déplacer tous les messages de la boîte de réception courante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //obtenir les IDs des 5 derniers messages reçus</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //supprimer les messages de la boite de réception courante</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="numtoid">.numToID()<a class="hash-link" href="#numtoid" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du premier message</td></tr><tr><td>endMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr><tr><td>Result</td><td>Collections</td><td align="center">&lt;-</td><td>Collection of unique IDs</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-23">Description<a class="hash-link" href="#description-23" title="Direct link to heading">​</a></h4><p>The <code>.numToID()</code> function converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em> in the currently selected mailbox.</p><p>Dans le paramètre <em>startMsg</em> passez une valeur <em>entier</em> correspondant au numéro du premier message dans une plage séquentielle. Si vous passez un nombre négatif (<em>startMsg</em> &lt;= 0), le premier message de la boîte de réception sera utilisé comme début de la séquence.</p><p>Dans le paramètre <em>endMsg</em> passez une valeur <em>entier long</em> correspondant au numéro du dernier message à inclure dans une plage séquentielle. Si vous passez un nombre négatif (<em>endMsg</em> &lt;= 0), le dernier message de la boîte de réception sera utilisé comme fin de séquence.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="result-6">Result<a class="hash-link" href="#result-6" title="Direct link to heading">​</a></h4><p>La fonction retourne une collection de chaînes (IDs uniques).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-13">Exemple<a class="hash-link" href="#exemple-13" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Créer le transporteur</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Sélectionner la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Marquer tous les messages de la boite de réception comme étant non vus</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$flags:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$flags[&quot;$seen&quot;]:=True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.removeFlags(IMAP all;$flags)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="removeflags">.removeFlags()<a class="hash-link" href="#removeflags" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collections</td><td align="center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d&#x27;un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée</td></tr><tr><td>keywords</td><td>Object</td><td align="center">-&gt;</td><td>Mots-clés de flags à supprimer</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the removeFlags operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-24">Description<a class="hash-link" href="#description-24" title="Direct link to heading">​</a></h4><p>The <code>.delete()</code> function sets the &quot;deleted&quot; flag for the messages defined in <code>msgsIDs</code> or <code>allMsgs</code>.</p><p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit :</p><ul><li><p>une <em>collection</em> contenant les IDs uniques de messages spécifiques, ou</p></li><li><p>l&#x27;ID unique (<em>texte</em>) d&#x27;un seul message ou</p></li><li><p>la constante suivante (<em>entier long</em>) pour tous les messages de la boîte sélectionnée :</p><table><thead><tr><th>Constante</th><th>Value</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr></tbody></table></li></ul><p>Le paramètre <code>keywords</code> vous permet de passer un objet avec des valeurs de mots-clés pour les flags spécifiques à supprimer des <code>msgIDs</code>. Vous pouvez utiliser les mots-clés suivants :</p><table><thead><tr><th>Paramètres</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;draft&quot; du message</td></tr><tr><td>$seen</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;seen&quot; du message</td></tr><tr><td>$flagged</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;flagged&quot; du message</td></tr><tr><td>$answered</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;answered&quot; du message</td></tr><tr><td>$deleted</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;deleted&quot; du message</td></tr></tbody></table><p>Les valeurs à faux sont ignorées.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-14">Exemple<a class="hash-link" href="#exemple-14" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $pw : text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// renommer la boite de réception</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.renameBox(&quot;Invoices&quot;; &quot;Bills&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Mailbox renaming successful!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="renamebox">.renameBox()<a class="hash-link" href="#renamebox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>currentName</td><td>Text</td><td align="center">-&gt;</td><td>Nom actuel de la boîte de réception</td></tr><tr><td>nouveauNom</td><td>Text</td><td align="center">-&gt;</td><td>Nouveau nom de la boîte de réception</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the renaming operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-25">Description<a class="hash-link" href="#description-25" title="Direct link to heading">​</a></h4><p>The <code>.renameBox()</code> function changes the name of a mailbox on the IMAP server. Essayer de renommer une mailbox qui n&#x27;existe pas ou de renommer une mailbox avec un nom qui est déjà utilisé génère une erreur.</p><p>Dans le paramètre <code>currentName</code>, passez le nom de la mailbox à renommer.</p><p>Passez le nouveau nom de la mailbox dans e paramètre <code>newName</code>.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-15">Exemple<a class="hash-link" href="#exemple-15" title="Direct link to heading">​</a></h4><p>Pour renommer la mailbox “Invoices” en “Bills”:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $pw : text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// rename mailbox</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.renameBox(&quot;Invoices&quot;; &quot;Bills&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Mailbox renaming successful!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="port">.port<a class="hash-link" href="#port" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.port</strong> : Integer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-26">Description<a class="hash-link" href="#description-26" title="Direct link to heading">​</a></h4><p>The <code>.port</code> property contains  the port number used for mail transactions. Par défaut, si la propriété <em>port</em> n&#x27;a pas été définie dans l&#x27;objet <em>server</em> (utilisé pour créer l&#x27;objet transporteur avec <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), le port utilisé est :</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="searchmails">.searchMails()<a class="hash-link" href="#searchmails" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>searchCriteria</td><td>Text</td><td align="center">-&gt;</td><td>Critère(s) de recherche</td></tr><tr><td>Result</td><td>Collections</td><td align="center">&lt;-</td><td>Collection of message numbers</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-27">Description<a class="hash-link" href="#description-27" title="Direct link to heading">​</a></h4><blockquote><p>Cette fonction est basée sur la spécification du <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol" target="_blank" rel="noopener noreferrer">protocole IMAP</a>.</p></blockquote><p>The <code>.searchMails()</code> function searches for messages that match the given <em>searchCriteria</em> in the current mailbox. .</p><p><em>searchCriteria</em> est un paramètre texte listant un ou plusieurs critères de recherche (voir <a href="#mots-cles-de-recherche-autorises">Mots-clés de recherche autorisés</a> ci-dessous) associés ou non à des valeurs à rechercher. Un critère de recherche peut être composé d&#x27;un ou plusieurs éléments.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">SearchKey1 = FLAGGED</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SearchKey2 = NOT FLAGGED</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>La correspondance n&#x27;est généralement pas sensible à la casse</p></blockquote><ul><li>Si <em>searchCriteria</em> est une chaîne vide, la recherche sera équivalente à un &quot;tout sélectionner&quot;.</li><li>Si <em>searchCriteria</em> contient plusieurs mots-clés de recherche, le résultat est l&#x27;intersection (fonction ET) de tous les messages qui correspondent à ces critères.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">searchCriteria = FLAGGED FROM &quot;SMITH&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne tous les messages comportant le marqueur \Flagged ET envoyés par Smith.</p><ul><li>Vous pouvez utiliser les opérateurs <strong>OR</strong> ou <strong>NOT</strong> comme suit :</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne tous les messages comportant le marqueur \Seen OU \Flagged</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne tous les messages ne comportant pas le marqueur \Seen.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot; NOT HEADER CONTENT-TYPE &quot;TEXT&quot;...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne les messages dont l&#x27;en-tête content-type contient “Mixed” et ne contient pas “Text”.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">searchCriteria = HEADER CONTENT-TYPE &quot;E&quot; NOT SUBJECT &quot;o&quot; NOT HEADER CONTENT-TYPE &quot;MIXED&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne les messages dont l&#x27;en-tête content-type contient “ e ” et dont l&#x27;en-tête Subject ne contient pas “ o ” et dont l&#x27;en-tête content-type n&#x27;est pas “ Mixed ”.</p><p>A noter que dans les deux derniers exemples, le résultat de la recherche est différent lorsque vous enlevez les parenthèses de la première liste de mots-clés.</p><ul><li>Le paramètre <em>searchCriteria</em> peut inclure optionnellement l&#x27;instruction <!-- -->[<!-- -->CHARSET]. Cette instruction est composée du mot &quot;CHARSET&quot; suivi d&#x27;un jeu de caractères défini <!-- -->[<!-- -->CHARSET] (US ASCII, ISO-8859). Elle indique le codage de caractères utilisé dans la chaine <em>searchCriteria</em>. Par conséquent, vous devez convertir la chaîne <em>searchCriteria</em> dans le jeu de caractères spécifié si vous utilisez l&#x27;instruction <!-- -->[<!-- -->CHARSET] (voir les commandes <code>CONVERT FROM TEXT</code> ou <code>Convert to text</code>). Par défaut, 4D encode la chaîne de critères searchCriteria en &quot;Quotable Printable&quot; si elle contient des caractères étendus.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">searchCriteria = CHARSET &quot;ISO-8859&quot; BODY &quot;Help&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>signifie que le critère de recherche utilise le jeu de caractères iso-8859 et que le serveur devra convertir la chaîne avant la recherche, si nécessaire.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mots-clés-de-recherche-autorisés">Mots-clés de recherche autorisés<a class="hash-link" href="#mots-clés-de-recherche-autorisés" title="Direct link to heading">​</a></h4><p>Les mots-clés de recherche peuvent traiter des valeurs des types suivants :</p><ul><li><p><strong>Search-keys with a field-name value</strong>: the field-name is the name of a header field. Example: <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li><li><p><strong>Valeurs de type chaîne </strong> : Les valeurs de type chaîne peuvent contenir tout type de caractère et doivent être placées entre des guillemets. Toutefois, si la chaîne ne contient pas de caractères spéciaux (des espaces par exemple), les guillemets ne sont pas obligatoires. Dans tous les cas, les guillemets vous permettent de vous assurer que la chaîne sera correctement interprétée. Example: <code>searchCriteria = FROM &quot;SMITH&quot;</code> For all search keys that use strings, a message matches the key if the string is a substring of the field. La recherche ne tient pas compte de la casse des caractères.</p></li><li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces. Example: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li><li><p><strong>Marqueurs</strong> : Les valeurs de type marqueur (flags) acceptent un ou plusieurs mots-clés (y compris des marqueurs standard) séparés par des espaces. Exemple : <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li><li><p><strong>Ensemble de messages</strong> : Les valeurs de ce type désignent un ensemble de messages. Elles contiennent une liste de numéros de messages dans un ordre croissant, de 1 au nombre total de messages dans la boîte aux lettres. Les numéros sont séparés par des virgules ; un deux-points (:) indique un intervalle (inclusif) de numéros. Examples: <code>2,4:7,9,12:*</code> is <code>2,4,5,6,7,9,12,13,14,15</code> for a mailbox with 15 messages. <code>searchCriteria = 1:5 ANSWERED</code> recherche, parmi les messages 1 à 5, ceux qui comportent le marqueur \Answered. <code>searchCriteria= 2,4 ANSWERED</code> recherche, parmi les messages 2 et 4, ceux qui comportent le marqueur \Answered.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mots-clés-de-recherche-autorisés-1">Mots-clés de recherche autorisés<a class="hash-link" href="#mots-clés-de-recherche-autorisés-1" title="Direct link to heading">​</a></h4><p><strong>ALL</strong>: Tous les messages de la boîte de réception.<br>
<strong>ANSWERED</strong>: Messages comportant le marqueur \Answered.<br>
<strong>UNANSWERED</strong>: Messages ne comportant pas le marqueur \Answered.<br>
<strong>DELETED</strong>: Messages comportant le marqueur \Deleted.<br>
<strong>UNDELETED</strong>: Messages ne comportant pas le marqueur \Deleted.<br>
<strong>DRAFT</strong>: Messages comportant le marqueur \Draft.<br>
<strong>UNDRAFT</strong>: Messages ne comportant pas le marqueur \Draft.<br>
<strong>FLAGGED</strong>: Messages comportant le marqueur \Flagged.<br>
<strong>UNFLAGGED</strong>: Messages ne comportant pas le marqueur \Flagged.<br>
<strong>RECENT</strong>: Messages comportant le marqueur \Recent.<br>
<strong>OLD</strong>: Messages ne comportant pas le marqueur \Recent.<br>
<strong>SEEN</strong>: Messages comportant le marqueur \Seen.<br>
<strong>UNSEEN</strong>: Messages ne comportant pas le marqueur \Seen.<br>
<strong>NEW</strong>: Messages comportant le marqueur \Recent et pas le marqueur \Seen. This is functionally equivalent to “(RECENT UNSEEN)”.<br>
<strong><em>KEYWORD </em></strong>flag<strong>**</strong>: Messages with the specified keyword set.<br>
<strong><em>UNKEYWORD </em></strong>flag<strong>**</strong>: Messages that do not have the specified keyword set.<br>
<strong><em>BEFORE </em></strong>date<strong>**</strong>: Messages whose internal date is earlier than the specified date.<br>
<strong><em>ON </em></strong>date<strong>**</strong>: Messages whose internal date is within the specified date.<br>
<strong><em>SINCE </em></strong>date<strong>**</strong>: Messages whose internal date is within or later than the specified date.<br>
<strong><em>SENTBEFORE </em></strong>date<strong>**</strong>: Messages whose Date header is earlier than the specified date.<br>
<strong><em>SENTON </em></strong>date<strong>**</strong>: Messages whose Date header is within the specified date.<br>
<strong><em>SENTSINCE </em></strong>date<strong>**</strong>: Messages whose Date header is within or later than the specified date.<br>
<strong><em>TO </em></strong>string<strong>**</strong>: Messages that contain the specified string in the TO header.<br>
<strong><em>FROM </em></strong>string<strong>**</strong>: Messages that contain the specified string in the FROM header.<br>
<strong><em>CC </em></strong>string<strong>**</strong>: Messages that contain the specified string in the CC header.<br>
<strong><em>BCC </em></strong>string<strong>**</strong>: Messages that contain the specified string in the BCC header.<br>
<strong><em>SUBJECT </em></strong>string<strong>**</strong>: Messages that contain the specified string in the Subject header.<br>
<strong><em>BODY </em></strong>string<strong>**</strong>: Messages that contain the specified string in the message body.<br>
<strong><em>TEXT </em></strong>string<strong>**</strong>: Messages that contain the specified string in the header or in the message body.<br>
<strong><em>HEADER </em>field-name* *</strong>string<strong>**</strong>: Messages that have a header with the specified field-name and that contain the specified string in the field-body.<br>
<strong><em>UID </em></strong>message-UID<strong>**</strong>: Messages with unique identifiers corresponding to the specified unique identifier set.<br>
<strong><em>LARGER </em></strong>n<strong>**</strong>: Messages with a size larger than the specified number of bytes.<br>
<strong><em>SMALLER </em></strong>n<strong>**</strong>: Messages with a size smaller than the specified number of bytes.<br>
<strong><em>NOT </em></strong>search-key<strong>**</strong>: Messages that do not match the specified search key.<br>
<strong><em>OR </em>search-key1* *</strong>search-key2<strong>**</strong>: Messages that match either search key.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="selectbox">.selectBox()<a class="hash-link" href="#selectbox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>state</td><td>Integer</td><td align="center">-&gt;</td><td>Statut de l&#x27;accès à la boite de réception</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>boxInfo object</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-28">Description<a class="hash-link" href="#description-28" title="Direct link to heading">​</a></h4><p>The <code>.selectBox()</code> function selects the <em>name</em> mailbox as the current mailbox. Cette fonction vous permet de récupérer des informations sur la boite de réception.</p><blockquote><p>Pour lire les informations à partir d&#x27;une mailbox sans changer la mailbox courante, utilisez <a href="#getboxinfo"><code>.getBoxInfo()</code></a>.</p></blockquote><p>Dans le paramètre optionnel <em>name</em> passez le nom de la boite de réception à laquelle vous souhaitez accéder. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. Le délimiteur peut être récupéré à l&#x27;aide de la fonction <a href="#getdelimiter"><code>.getDelimiter()</code></a>.</p><p>Le paramètre optionnel <em>state</em> définit le type d&#x27;accès à la mailbox. Les valeurs possibles sont les suivantes :</p><table><thead><tr><th>Constante</th><th>Value</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP read only state</td><td>1</td><td>La mailbox sélectionnée est accessible avec les privilèges de lecture seule. Les messages contenant un marqueur &quot;recent&quot; (indication de nouveaux messages) restent inchangés.</td></tr><tr><td>IMAP read write state</td><td>0</td><td>La mailbox sélectionnée est accessible avec des privilèges de lecture et d&#x27;écriture. Les messages sont considérés &quot;seen&quot; et perdent le marqueur &quot;recent&quot; (indication des nouveaux messages). (Valeur par défaut)</td></tr></tbody></table><blockquote><ul><li>La fonction génère une erreur et retourne <strong>Null</strong> si <em>name</em> désigne une mailbox inexistante.</li><li>Si aucune connexion n&#x27;est ouverte, <code>.selectBox()</code> ouvrira une connexion.</li><li>Si la connexion n&#x27;a pas été utilisée depuis le délai de connexion (voir <code>IMAP New transporter</code>), la fonction <a href="#checkconnection"><code>.checkConnection( )</code></a> est automatiquement appelée.</li></ul></blockquote><p><strong>Objet retourné</strong></p><p>L&#x27;objet <code>boxInfo</code> contient les propriété suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td>Nom de la boîte de réception</td></tr><tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>mailRecent</td><td>number</td><td>Nombre de messages avec le marqueur &quot;recent&quot;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-16">Exemple<a class="hash-link" href="#exemple-16" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $pw; $name : text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Mailbox subscription successful!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="subscribe">.subscribe()<a class="hash-link" href="#subscribe" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the subscribe operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-29">Description<a class="hash-link" href="#description-29" title="Direct link to heading">​</a></h4><p>The <code>.subscribe()</code> function allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes. .</p><p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à ajouter (subscribe) à la liste de mailboxes auxquelles vous avez &quot;souscrit&quot;.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-17">Exemple<a class="hash-link" href="#exemple-17" title="Direct link to heading">​</a></h4><p>Pour souscrire à la mailbox &quot;Atlas Corp” dans la hiérarchie &quot;Bills&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Mailbox subscription successful!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unsubscribe">.unsubscribe()<a class="hash-link" href="#unsubscribe" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>nom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Status of the unsubscribe operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-30">Description<a class="hash-link" href="#description-30" title="Direct link to heading">​</a></h4><p>The <code>.unsubscribe()</code> function removes a mailbox from a set of subscribed mailboxes. Elle vous permet de réduire le nombre de mailboxes que vous consultez régulièrement.</p><p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à supprimer (unsubscribe) de la liste de mailboxes auxquelles vous avez &quot;souscrit&quot;.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collections</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-18">Exemple<a class="hash-link" href="#exemple-18" title="Direct link to heading">​</a></h4><p>Pour ne plus souscrire à la mailbox &quot;Atlas Corp” dans la hiérarchie &quot;Bills&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$status:=$transporter.unsubscribe($name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Mailbox unsubscription successful!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user">.user<a class="hash-link" href="#user" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.user</strong> : Text</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-31">Description<a class="hash-link" href="#description-31" title="Direct link to heading">​</a></h4><p>The <code>.user</code> property contains  the user name used for authentication on the mail server.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/fr/API/HTTPRequestClass"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">HTTPRequest</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/fr/API/MailAttachmentClass"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MailAttachment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objet-imap-transporter" class="table-of-contents__link toc-highlight">Objet IMAP Transporter</a></li><li><a href="#imap-new-transporter" class="table-of-contents__link toc-highlight">IMAP New transporter</a></li><li><a href="#4dimaptransporternew" class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection" class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a></li><li><a href="#addflags" class="table-of-contents__link toc-highlight">.addFlags()</a></li><li><a href="#append" class="table-of-contents__link toc-highlight">.append()</a></li><li><a href="#authenticationmode" class="table-of-contents__link toc-highlight">.authenticationMode</a></li><li><a href="#checkconnection" class="table-of-contents__link toc-highlight">.checkConnection()</a></li><li><a href="#checkconnectiondelay" class="table-of-contents__link toc-highlight">.checkConnectionDelay</a></li><li><a href="#connectiontimeout" class="table-of-contents__link toc-highlight">.connectionTimeOut</a></li><li><a href="#copy" class="table-of-contents__link toc-highlight">.copy()</a></li><li><a href="#createbox" class="table-of-contents__link toc-highlight">.createBox()</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">.delete()</a></li><li><a href="#deletebox" class="table-of-contents__link toc-highlight">.deleteBox()</a></li><li><a href="#expunge" class="table-of-contents__link toc-highlight">.expunge()</a></li><li><a href="#getboxinfo" class="table-of-contents__link toc-highlight">.getBoxInfo()</a></li><li><a href="#getboxlist" class="table-of-contents__link toc-highlight">.getBoxList()</a></li><li><a href="#getdelimiter" class="table-of-contents__link toc-highlight">.getDelimiter()</a></li><li><a href="#getmail" class="table-of-contents__link toc-highlight">.getMail()</a></li><li><a href="#getmails" class="table-of-contents__link toc-highlight">.getMails()</a></li><li><a href="#getmimeasblob" class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a></li><li><a href="#host" class="table-of-contents__link toc-highlight">.host</a></li><li><a href="#logfile" class="table-of-contents__link toc-highlight">.logFile</a></li><li><a href="#move" class="table-of-contents__link toc-highlight">.move()</a></li><li><a href="#numtoid" class="table-of-contents__link toc-highlight">.numToID()</a></li><li><a href="#removeflags" class="table-of-contents__link toc-highlight">.removeFlags()</a></li><li><a href="#renamebox" class="table-of-contents__link toc-highlight">.renameBox()</a></li><li><a href="#port" class="table-of-contents__link toc-highlight">.port</a></li><li><a href="#searchmails" class="table-of-contents__link toc-highlight">.searchMails()</a></li><li><a href="#selectbox" class="table-of-contents__link toc-highlight">.selectBox()</a></li><li><a href="#subscribe" class="table-of-contents__link toc-highlight">.subscribe()</a></li><li><a href="#unsubscribe" class="table-of-contents__link toc-highlight">.unsubscribe()</a></li><li><a href="#user" class="table-of-contents__link toc-highlight">.user</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Developer Center</a></li><li class="footer__item"><a href="https://blog.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Blog</a></li><li class="footer__item"><a href="https://discuss.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Forum</a></li><li class="footer__item"><a href="https://facebook.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/user/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/4D" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Doc Center (Where It All Began)</a></li><li class="footer__item"><a href="https://kb.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Knowledgebase</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ressources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-technical-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">About 4D<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-around-the-world" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D around the world<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/Careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2022 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/fr/assets/js/runtime~main.67d1bd84.js"></script>
<script src="/docs/fr/assets/js/main.b3efc654.js"></script>
</body>
</html>