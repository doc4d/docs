"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[78182],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=p(n),k=a,c=d["".concat(s,".").concat(k)]||d[k]||m[k]||l;return n?r.createElement(c,i(i({ref:t},u),{},{components:n})):r.createElement(c,i({ref:t},u))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var p=2;p<l;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},52510:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>u});n(67294);var r=n(3905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const i={id:"POP3TransporterClass",title:"POP3Transporter"},o=void 0,s={unversionedId:"API/POP3TransporterClass",id:"API/POP3TransporterClass",title:"POP3Transporter",description:"La classe POP3Transporter vous permet de r\xe9cup\xe9rer des messages \xe0 partir d'un serveur de messagerie POP3.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/API/POP3TransporterClass.md",sourceDirName:"API",slug:"/API/POP3TransporterClass",permalink:"/docs/fr/next/API/POP3TransporterClass",draft:!1,tags:[],version:"current",frontMatter:{id:"POP3TransporterClass",title:"POP3Transporter"},sidebar:"docs",previous:{title:"MailAttachment",permalink:"/docs/fr/next/API/MailAttachmentClass"},next:{title:"Session",permalink:"/docs/fr/next/API/SessionClass"}},p={},u=[{value:"Objet POP3 Transporter",id:"objet-pop3-transporter",level:3},{value:"POP3 New transporter",id:"pop3-new-transporter",level:2},{value:"Description",id:"description",level:4},{value:"Result",id:"result",level:4},{value:"Exemple",id:"exemple",level:4},{value:"4D.POP3Transporter.new()",id:"4dpop3transporternew",level:2},{value:"Description",id:"description-1",level:4},{value:".acceptUnsecureConnection",id:"acceptunsecureconnection",level:2},{value:"Description",id:"description-2",level:4},{value:".authenticationMode",id:"authenticationmode",level:2},{value:"Description",id:"description-3",level:4},{value:".checkConnection()",id:"checkconnection",level:2},{value:"Description",id:"description-4",level:4},{value:"Objet retourn\xe9",id:"objet-retourn\xe9",level:4},{value:"Exemple",id:"exemple-1",level:4},{value:".connectionTimeOut",id:"connectiontimeout",level:2},{value:"Description",id:"description-5",level:4},{value:".delete()",id:"delete",level:2},{value:"Description",id:"description-6",level:5},{value:"Exemple",id:"exemple-2",level:5},{value:".getBoxInfo()",id:"getboxinfo",level:2},{value:"Description",id:"description-7",level:5},{value:"Exemple",id:"exemple-3",level:5},{value:".getMail()",id:"getmail",level:2},{value:"Description",id:"description-8",level:5},{value:"Exemple",id:"exemple-4",level:5},{value:".getMailInfo()",id:"getmailinfo",level:2},{value:"Description",id:"description-9",level:5},{value:"Exemple",id:"exemple-5",level:5},{value:".getMailInfoList()",id:"getmailinfolist",level:2},{value:"Description",id:"description-10",level:5},{value:"Propri\xe9t\xe9s number et ID",id:"propri\xe9t\xe9s-number-et-id",level:4},{value:"Exemple",id:"exemple-6",level:5},{value:".getMIMEAsBlob()",id:"getmimeasblob",level:2},{value:"Description",id:"description-11",level:5},{value:"Exemple",id:"exemple-7",level:5},{value:".host",id:"host",level:2},{value:"Description",id:"description-12",level:4},{value:".logFile",id:"logfile",level:2},{value:"Description",id:"description-13",level:4},{value:".port",id:"port",level:2},{value:"Description",id:"description-14",level:4},{value:".undeleteAll()",id:"undeleteall",level:2},{value:"Description",id:"description-15",level:5},{value:".user",id:"user",level:2},{value:"Description",id:"description-16",level:4}],m={toc:u};function d(e){var{components:t}=e,n=l(e,["components"]);return(0,r.kt)("wrapper",a({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"La classe ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3Transporter")," vous permet de r\xe9cup\xe9rer des messages \xe0 partir d'un serveur de messagerie POP3."),(0,r.kt)("h3",a({},{id:"objet-pop3-transporter"}),"Objet POP3 Transporter"),(0,r.kt)("p",null,"Les objets Transporter POP3 sont instanci\xe9s avec la commande ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-new-transporter"}),"POP3 New transporter"),". Leurs propri\xe9t\xe9s et fonctions sont les suivantes :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}))))),(0,r.kt)("p",null,"| ",(0,r.kt)("a",a({parentName:"p"},{href:"#acceptunsecureconnection"}),(0,r.kt)("strong",{parentName:"a"},".acceptUnsecureConnection")," : Boolean"),"\xa0","\xa0","\xa0","\xa0",(0,r.kt)("strong",{parentName:"p"},"True")," if 4D is allowed to establish an unencrypted connection|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#authenticationmode"}),(0,r.kt)("strong",{parentName:"a"},".authenticationMode")," : Text"),"\xa0","\xa0","\xa0","\xa0","the authentication mode used to open the session on the mail server|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#checkconnection"}),(0,r.kt)("strong",{parentName:"a"},".checkConnection()")," : Object"),"\xa0","\xa0","\xa0","\xa0"," checks the connection using information stored in the transporter object|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#connectiontimeout"}),(0,r.kt)("strong",{parentName:"a"},".connectionTimeOut")," : Integer"),"\xa0","\xa0","\xa0","\xa0","the maximum wait time (in seconds) allowed to establish a connection to the server|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#delete"}),(0,r.kt)("strong",{parentName:"a"},".delete"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : Integer )"),"\xa0","\xa0","\xa0","\xa0","flags the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," email for deletion from the POP3 server|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#getboxinfo"}),(0,r.kt)("strong",{parentName:"a"},".getBoxInfo()")," : Object"),"\xa0","\xa0","\xa0","\xa0","The ",(0,r.kt)("inlineCode",{parentName:"p"},".getBoxInfo()")," function|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmail"}),(0,r.kt)("strong",{parentName:"a"},".getMail"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : Integer ) : Object"),"\xa0","\xa0","\xa0","\xa0","The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMail()")," function|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmailinfo"}),(0,r.kt)("strong",{parentName:"a"},".getMailInfo"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : Integer ) : Object"),"\xa0","\xa0","\xa0","\xa0","returns a ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," object corresponding  corresponding to the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3 transporter")),"|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmailinfolist"}),(0,r.kt)("strong",{parentName:"a"},".getMailInfoList()")," : Collection"),"\xa0","\xa0","\xa0","\xa0","returns a collection of ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," objects describing all messages in the mailbox designated by the ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3 transporter")),"|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmimeasblob"}),(0,r.kt)("strong",{parentName:"a"},".getMIMEAsBlob"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : Integer ) : Blob"),"\xa0","\xa0","\xa0","\xa0","The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," function|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#host"}),(0,r.kt)("strong",{parentName:"a"},".host")," : Text"),"\xa0","\xa0","\xa0","\xa0","the name or the IP address of the host server|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#logfile"}),(0,r.kt)("strong",{parentName:"a"},".logFile")," : Text"),"\xa0","\xa0","\xa0","\xa0","the path of the extended log file defined (if any) for the mail connection|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#port"}),(0,r.kt)("strong",{parentName:"a"},".port")," : Integer"),"\xa0","\xa0","\xa0","\xa0"," the port number used for mail transactions|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#undeleteall"}),(0,r.kt)("strong",{parentName:"a"},".undeleteAll()")),"\xa0","\xa0","\xa0","\xa0","removes all delete flags set on the emails in the ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3_transporter")),"|\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#user"}),(0,r.kt)("strong",{parentName:"a"},".user")," : Text"),"\xa0","\xa0","\xa0","\xa0"," the user name used for authentication on the mail server|"),(0,r.kt)("h2",a({},{id:"pop3-new-transporter"}),"POP3 New transporter"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"POP3 New transporter"),"( ",(0,r.kt)("em",{parentName:"p"},"server")," : Object ) : 4D.POP3Transporter\n| Param\xe8tres | Type               |    | Description                                                                    |\n| ---------- | ------------------ |:--:| ------------------------------------------------------------------------------ |\n| server     | object             | -> | Informations sur le serveur IMAP                                               |\n| Result     | 4D.POP3Transporter | <- | ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),"POP3 transporter object"),"|\n|"),(0,r.kt)("h4",a({},{id:"description"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 New transporter")," command configures a new POP3 connectionaccording to the ",(0,r.kt)("em",{parentName:"p"},"server")," parameter and returns a new ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",a({parentName:"em"},{href:"#pop3-transporter-object"}),"POP3 transporter"))," object. L'objet transporteur retourn\xe9 sera alors utilis\xe9 pour la r\xe9ception d'emails."),(0,r.kt)("p",null,"Dans le param\xe8tre ",(0,r.kt)("em",{parentName:"p"},"server"),", passez un objet contenant les propri\xe9t\xe9s suivantes :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),(0,r.kt)("em",{parentName:"th"},"server")),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Valeur par d\xe9faut (si omise)")))),(0,r.kt)("p",null,"| ",(0,r.kt)("a",a({parentName:"p"},{href:"#acceptunsecureconnection"}),(0,r.kt)("strong",{parentName:"a"},".acceptUnsecureConnection")," : Boolean"),"\xa0","\xa0","\xa0","\xa0",(0,r.kt)("strong",{parentName:"p"},"True")," if 4D is allowed to establish an unencrypted connection| False                                                                            |\n| .",(0,r.kt)("strong",{parentName:"p"},"accessTokenOAuth2"),": Text",(0,r.kt)("br",null),".",(0,r.kt)("strong",{parentName:"p"},"accessTokenOAuth2"),": Object",(0,r.kt)("br",null),"Text string or token object representing OAuth2 authorization credentials. Il est utilis\xe9 uniquement avec OAUTH2 ",(0,r.kt)("inlineCode",{parentName:"p"},"authenticationMode"),". Si ",(0,r.kt)("inlineCode",{parentName:"p"},"accessTokenOAuth2")," est utilis\xe9 mais que ",(0,r.kt)("inlineCode",{parentName:"p"},"authenticationMode")," est omis, le protocole OAuth 2 est utilis\xe9 (si le serveur l'autorise). Cha\xeene de texte ou objet token repr\xe9sentant les informations d'autorisation OAuth2. | aucun                                                                            |\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#authenticationmode"}),(0,r.kt)("strong",{parentName:"a"},".authenticationMode")," : Text"),"\xa0","\xa0","\xa0","\xa0","the authentication mode used to open the session on the mail server| le mode d'authentification le plus s\xfbr pris en charge par le serveur est utilis\xe9 |\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#connectiontimeout"}),(0,r.kt)("strong",{parentName:"a"},".connectionTimeOut")," : Integer"),"\xa0","\xa0","\xa0","\xa0","the maximum wait time (in seconds) allowed to establish a connection to the server| 30                                                                               |\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#host"}),(0,r.kt)("strong",{parentName:"a"},".host")," : Text"),"\xa0","\xa0","\xa0","\xa0","the name or the IP address of the host server| ",(0,r.kt)("em",{parentName:"p"},"obligatoire"),"                                                                    |\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#logfile"}),(0,r.kt)("strong",{parentName:"a"},".logFile")," : Text"),"\xa0","\xa0","\xa0","\xa0","the path of the extended log file defined (if any) for the mail connection| aucun                                                                            |\n| ",(0,r.kt)("strong",{parentName:"p"},".password")," : Text",(0,r.kt)("br",null),"User password for authentication on the server. Cha\xeene de texte ou objet token repr\xe9sentant les informations d'autorisation OAuth2.                                                                                                                                                                                                                                                                                 | aucun                                                                            |\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#port"}),(0,r.kt)("strong",{parentName:"a"},".port")," : Integer"),"\xa0","\xa0","\xa0","\xa0"," the port number used for mail transactions| 995                                                                              |\n| ",(0,r.kt)("a",a({parentName:"p"},{href:"#user"}),(0,r.kt)("strong",{parentName:"a"},".user")," : Text"),"\xa0","\xa0","\xa0","\xa0"," the user name used for authentication on the mail server| aucun                                                                            |"),(0,r.kt)("h4",a({},{id:"result"}),"Result"),(0,r.kt)("p",null,"La fonction retourne un ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("strong",{parentName:"a"},"objet POP3 transporter")),". Toutes les propri\xe9t\xe9s retourn\xe9es sont en ",(0,r.kt)("strong",{parentName:"p"},"lecture seule"),"."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"La connexion POP3 est automatiquement ferm\xe9e lorsque l'objet transporteur est d\xe9truit.")),(0,r.kt)("h4",a({},{id:"exemple"}),"Exemple"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $server : Object\n $server:=New object\n $server.host:="pop.gmail.com" //Obligatoire\n $server.port:=995\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n $server.logFile:="LogTest.txt" //log \xe0 enregistrer dans le dossier Logs\n\n var $transporter : 4D.POP3Transporter\n $transporter:=POP3 New transporter($server)\n\n $status:=$transporter.checkConnection()\n If(Not($status.success))\n    ALERT("An error occurred receiving the mail: "+$status.statusText)\n End if\n')),(0,r.kt)("h2",a({},{id:"4dpop3transporternew"}),"4D.POP3Transporter.new()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"4D.POP3Transporter.new"),"( ",(0,r.kt)("em",{parentName:"p"},"server")," : Object ) : 4D.POP3Transporter\n| Param\xe8tres | Type               |    | Description                                                                    |\n| ---------- | ------------------ |:--:| ------------------------------------------------------------------------------ |\n| server     | Object             | -> | Informations sur le serveur IMAP                                               |\n| Result     | 4D.POP3Transporter | <- | ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),"POP3 transporter object"),"|\n|"),(0,r.kt)("h4",a({},{id:"description-1"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"4D.POP3Transporter.new()")," function creates and returns a new object of the ",(0,r.kt)("inlineCode",{parentName:"p"},"4D.POP3Transporter")," type. ."),(0,r.kt)("h2",a({},{id:"acceptunsecureconnection"}),".acceptUnsecureConnection"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R4"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".acceptUnsecureConnection")," : Boolean"),(0,r.kt)("h4",a({},{id:"description-2"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".acceptUnsecureConnection")," property contains ",(0,r.kt)("strong",{parentName:"p"},"True")," if 4D is allowed to establish an unencrypted connection when encrypted connection is not possible."),(0,r.kt)("p",null,"Elle contient ",(0,r.kt)("strong",{parentName:"p"},"False")," si les connexions non chiffr\xe9es ne sont pas autoris\xe9es, auquel cas une erreur est retourn\xe9e lorsque la connexion chiffr\xe9e n'est pas possible."),(0,r.kt)("p",null,"Ports s\xe9curis\xe9s disponibles :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"SMTP"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"465: SMTPS"),(0,r.kt)("li",{parentName:"ul"},"587 ou 25 : SMTP avec mise \xe0 niveau STARTTLS si le serveur le prend en charge."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"IMAP"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"143 : Port IMAP non chiffr\xe9"),(0,r.kt)("li",{parentName:"ul"},"993 : IMAP avec mise \xe0 niveau STARTTLS si le serveur le prend en charge"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"POP3"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"110 : Port POP3 non chiffr\xe9"),(0,r.kt)("li",{parentName:"ul"},"995 : POP3 avec mise \xe0 niveau STARTTLS si le serveur le prend en charge.")))),(0,r.kt)("h2",a({},{id:"authenticationmode"}),".authenticationMode"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R4"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".authenticationMode")," : Text"),(0,r.kt)("h4",a({},{id:"description-3"}),"Description"),(0,r.kt)("p",null,"La propri\xe9t\xe9 ",(0,r.kt)("inlineCode",{parentName:"p"},".authenticationMode")," contient le mode d'authentification utilis\xe9 pour ouvrir la session sur le serveur de messagerie."),(0,r.kt)("p",null,"Par d\xe9faut, le mode le plus s\xe9curis\xe9 pris en charge par le serveur est utilis\xe9."),(0,r.kt)("p",null,"Valeurs possibles :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Value"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Constantes"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Commentaire"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"APOP"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"POP3 authentication APOP")),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole APOP (POP3 uniquement)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"CRAM-MD5"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"POP3 authentication CRAM-MD5")),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole CRAM-MD5")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"LOGIN"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"POP3 authentication login")),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole LOGIN")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"OAUTH2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"POP3 authentication OAUTH2")),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole OAuth2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"PLAIN"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"POP3 authentication plain")),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole PLAIN")))),(0,r.kt)("h2",a({},{id:"checkconnection"}),".checkConnection()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R4"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".checkConnection()")," : Object\n| Param\xe8tres | Type   |    | Description                                                               |\n| ---------- | ------ |:--:| ------------------------------------------------------------------------- |\n| Result     | Object | <- | Statut de la connexion de l'objet transporteur|\n|"),(0,r.kt)("h4",a({},{id:"description-4"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".checkConnection()")," function  checks the connection using information stored in the transporter object, recreates the connection if necessary, and returns the status. Cette fonction vous permet de v\xe9rifier que les valeurs fournies par l'utilisateur sont valides et coh\xe9rentes."),(0,r.kt)("h4",a({},{id:"objet-retourn\xe9"}),"Objet retourn\xe9"),(0,r.kt)("p",null,"La fonction envoie une requ\xeate au serveur de mail et retourne un objet d\xe9crivant le statut. Cet objet peut avoir les propri\xe9t\xe9s suivantes :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,r.kt)("th",a({parentName:"tr"},{align:null})),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Type"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"success"),(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"boolean"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Vrai si la v\xe9rification a \xe9t\xe9 effectu\xe9e avec succ\xe8s, sinon Faux")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"status"),(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"(SMTP uniquement) Code du statut retourn\xe9 par le serveur de messagerie (0 en cas de probl\xe8me non li\xe9 au traitement du mail)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"statusText"),(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"text"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur de messagerie, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"errors"),(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"collection"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur de messagerie est re\xe7ue)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"["," ].errCode"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"["," ].message"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"text"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null})),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"["," ].componentSignature"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"text"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,r.kt)("h4",a({},{id:"exemple-1"}),"Exemple"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $pw :  Text\n var $options : Object\n $options:=New object\n\n $pw:=Request("Please enter your password:")\n if(OK=1)\n    $options.host:="pop3.gmail.com"\n\n    $options.user:="test@gmail.com"\n    $options.password:=$pw\n\n    $transporter:=POP3 New transporter($options)\n\n    $status:=$transporter.checkConnection()\n    If($status.success)\n       ALERT("POP3 connection check successful!")\n    Else\n       ALERT("Error: "+$status.statusText)\n    End if\n End if\n    Else\n       ALERT("Error: "+$status.statusText)\n    End if\n End if\n')),(0,r.kt)("h2",a({},{id:"connectiontimeout"}),".connectionTimeOut"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R5"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".connectionTimeOut")," : Integer"),(0,r.kt)("h4",a({},{id:"description-5"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".connectionTimeOut")," property contains the maximum wait time (in seconds) allowed to establish a connection to the server. Par d\xe9faut, si la propri\xe9t\xe9 n'a pas \xe9t\xe9 d\xe9finie dans l'objet server (utilis\xe9 pour cr\xe9er l'objet transporteur avec ",(0,r.kt)("inlineCode",{parentName:"p"},"SMTP New transporter"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 New transporter"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"IMAP New transporter"),"), la valeur utilis\xe9e est 30."),(0,r.kt)("h2",a({},{id:"delete"}),".delete()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".delete"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : Integer )\n| Param\xe8tres | Type    |    | Description                                              |\n| ---------- | ------- |:--:| -------------------------------------------------------- |\n| msgNumber  | Integer | -> | Num\xe9ro du message \xe0 supprimer|\n|"),(0,r.kt)("h5",a({},{id:"description-6"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".delete( )")," function flags the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," email for deletion from the POP3 server."),(0,r.kt)("p",null,"Dans le param\xe8tre ",(0,r.kt)("em",{parentName:"p"},"msgNumber"),", passez le num\xe9ro de l'email \xe0 supprimer. Ce num\xe9ro est retourn\xe9 dans la propri\xe9t\xe9 number par la fonction ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmailinfolist"}),(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()")),"."),(0,r.kt)("p",null,"L'ex\xe9cution de cette m\xe9thode ne supprime pas r\xe9ellement l'email. L'email marqu\xe9 sera supprim\xe9 sur le serveur POP3 uniquement lorsque l'objet ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," (cr\xe9\xe9 \xe0 l'aide de ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 New transporter"),") sera d\xe9truit. Le marqueur pourra \xe9galement \xeatre retir\xe9 via la fonction ",(0,r.kt)("inlineCode",{parentName:"p"},".undeleteAll()"),"."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Si la session courante se termine inopin\xe9ment et que le connexion est ferm\xe9e (ex : timeout, panne de r\xe9seau, etc.), un message d'erreur est g\xe9n\xe9r\xe9 et les messages marqu\xe9s pour suppression demeureront sur le serveur POP3.")),(0,r.kt)("h5",a({},{id:"exemple-2"}),"Exemple"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' $mailInfoList:=$POP3_transporter.getMailInfoList()\n For each($mailInfo;$mailInfoList)\n  // Marquer votre e-mail comme "\xe0 supprimer \xe0 la fin de la session"\n    $POP3_transporter.delete($mailInfo.number)\n End for each\n  // Forcer la fermeture de la session pour supprimer les e-mails marqu\xe9s pour suppression\n CONFIRM("Selected messages will be deleted.";"Delete";"Undo")\n If(OK=1) //suppression confirm\xe9e\n    $POP3_transporter:=Null\n Else\n    $POP3_transporter.undeleteAll() //supprimer les marqueurs de suppression\n End if\n')),(0,r.kt)("h2",a({},{id:"getboxinfo"}),".getBoxInfo()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getBoxInfo()")," : Object\n| Param\xe8tres | Type   |    | Description                               |\n| ---------- | ------ |:--:| ----------------------------------------- |\n| Result     | Object | <- | boxInfo object|\n|"),(0,r.kt)("h5",a({},{id:"description-7"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getBoxInfo()")," function The ",(0,r.kt)("inlineCode",{parentName:"p"},".getBoxInfo()")," function. Cette fonction vous permet de r\xe9cup\xe9rer des informations sur la boite de r\xe9ception."),(0,r.kt)("p",null,"L'objet ",(0,r.kt)("inlineCode",{parentName:"p"},"boxInfo")," contient les propri\xe9t\xe9 suivantes :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Type"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"mailCount"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Nombre de messages contenus dans la bo\xeete de r\xe9ception")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"size"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Taille du message en octets")))),(0,r.kt)("h5",a({},{id:"exemple-3"}),"Exemple"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $server; $boxinfo : Object\n\n $server:=New object\n $server.host:="pop.gmail.com" //Obligatoire\n $server.port:=995\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=POP3 New transporter($server)\n\n  //mailbox info\n $boxInfo:=$transporter.getBoxInfo()\n ALERT("The mailbox contains "+String($boxInfo.mailCount)+" messages.")\n')),(0,r.kt)("h2",a({},{id:"getmail"}),".getMail()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMail"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : Integer ) : Object\n| Param\xe8tres | Type    |    | Description                                                                 |\n| ---------- | ------- |:--:| --------------------------------------------------------------------------- |\n| msgNumber  | Integer | -> | Num\xe9ro du message dans la liste                                             |\n| Result     | Object  | <- | ",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/fr/next/API/EmailObjectClass#email-object"}),"Email object"),"|\n|"),(0,r.kt)("h5",a({},{id:"description-8"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMail()")," function The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMail()")," function. Cette fonction vous permet de g\xe9rer localement le contenu de l'email."),(0,r.kt)("p",null,"Passez dans ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," le num\xe9ro du message \xe0 r\xe9cup\xe9rer. Ce num\xe9ro est retourn\xe9 dans la propri\xe9t\xe9 number par la fonction ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmailinfolist"}),(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()")),"."),(0,r.kt)("p",null,"La fonction retourne Null si :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"msgNumber")," d\xe9signe un message inexistant,"),(0,r.kt)("li",{parentName:"ul"},"le message a \xe9t\xe9 marqu\xe9 pour suppression \xe0 l'aide de ",(0,r.kt)("inlineCode",{parentName:"li"},".delete()"),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},".getMail()")," retourne un ",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/fr/next/API/EmailObjectClass#email-object"}),"objet ",(0,r.kt)("inlineCode",{parentName:"a"},"Email")),"."),(0,r.kt)("h5",a({},{id:"exemple-4"}),"Exemple"),(0,r.kt)("p",null,"Vous souhaitez connaitre l'exp\xe9diteur du premier mail de la boite de r\xe9ception :"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $server; $transporter : Object\n var $mailInfo : Collection\n var $sender : Variant\n\n $server:=New object\n $server.host:="pop.gmail.com" //Obligatoire\n $server.port:=995\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=POP3 New transporter($server)\n\n $mailInfo:=$transporter.getMailInfoList()\n $sender:=$transporter.getMail($mailInfo[0].number).from\n')),(0,r.kt)("h2",a({},{id:"getmailinfo"}),".getMailInfo()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMailInfo"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : Integer ) : Object\n| Param\xe8tres | Type    |    | Description                               |\n| ---------- | ------- |:--:| ----------------------------------------- |\n| msgNumber  | Integer | -> | Num\xe9ro du message dans la liste           |\n| Result     | Object  | <- | Objet MailInfo|\n|"),(0,r.kt)("h5",a({},{id:"description-9"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMailInfo()")," function returns a ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," object corresponding  corresponding to the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3 transporter")),". Cette fonction vous permet de r\xe9cup\xe9rer des informations sur l'email."),(0,r.kt)("p",null,"Dans le param\xe8tre ",(0,r.kt)("em",{parentName:"p"},"msgNumber"),", passez le num\xe9ro de l'email \xe0 r\xe9cup\xe9rer. Ce num\xe9ro est retourn\xe9 dans la propri\xe9t\xe9 number par la fonction ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmailinfolist"}),(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()")),"."),(0,r.kt)("p",null,"L'objet ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," retourn\xe9 contient les propri\xe9t\xe9 suivantes :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Type"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"size"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Taille du message en octets")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"id"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Text"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"ID unique du message")))),(0,r.kt)("p",null,"La fonction retourne ",(0,r.kt)("strong",{parentName:"p"},"Null")," si :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"msgNumber")," d\xe9signe un message inexistant,"),(0,r.kt)("li",{parentName:"ul"},"le message a \xe9t\xe9 marqu\xe9 pour suppression \xe0 l'aide de ",(0,r.kt)("inlineCode",{parentName:"li"},".delete()"),".")),(0,r.kt)("h5",a({},{id:"exemple-5"}),"Exemple"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $server; $mailInfo : Object\n var $mailNumber : Integer\n\n $server.host:="pop.gmail.com" //Mandatory\n $server.port:=995\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n var $transporter : 4D.POP3Transporter\n $transporter:=POP3 New transporter($server)\n\n  //message info\n $mailInfo:=$transporter.getMailInfo(1) //get the first mail\n If($mailInfo #Null)\n    ALERT("First mail size is:"+String($mailInfo.size)+" bytes.")\n End if\n End if\n')),(0,r.kt)("h2",a({},{id:"getmailinfolist"}),".getMailInfoList()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMailInfoList()")," : Collection\n| Param\xe8tres | Type        |    | Description                                               |\n| ---------- | ----------- |:--:| --------------------------------------------------------- |\n| Result     | Collections | <- | Collection d'objets ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo"),"|\n|"),(0,r.kt)("h5",a({},{id:"description-10"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMailInfoList()")," function returns a collection of ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," objects describing all messages in the mailbox designated by the ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3 transporter")),". Cette fonction vous permet de g\xe9rer localement les listes de messages situ\xe9s sur le serveur de messagerie POP3."),(0,r.kt)("p",null,"Chaque objet ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," retourn\xe9 contient les propri\xe9t\xe9 suivantes :"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Type"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"["," ].size"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Taille du message en octets")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"["," ].number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Number"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Num\xe9ro du message")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"["," ].id"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Text"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"ID unique du message (utile si vous stockez le message localement)")))),(0,r.kt)("p",null,"Si la bo\xeete de r\xe9ception ne contient pas de message, une collection vide est retourn\xe9e."),(0,r.kt)("h4",a({},{id:"propri\xe9t\xe9s-number-et-id"}),"Propri\xe9t\xe9s number et ID"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"number")," est le num\xe9ro d'un message de la boite de r\xe9ception au moment de la cr\xe9ation du ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter"),". La propri\xe9t\xe9 ",(0,r.kt)("em",{parentName:"p"},"number")," n'est pas une valeur statique li\xe9e \xe0 un message sp\xe9cifique. Elle change d'une session \xe0 l'autre en fonction de sa relation \xe0 d'autres messages de la bo\xeete de r\xe9ception au moment de l'ouverture de la session. Les num\xe9ros assign\xe9s aux messages sont valides uniquement pendant la dur\xe9e de vie du ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3_transporter")),". Lorsque le ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," est supprim\xe9, les messages marqu\xe9s pour suppression seront supprim\xe9s. Lorsque l'utilisateur se reconnecte au serveur, les messages courants de la bo\xeete de r\xe9ception sont renum\xe9rot\xe9s de 1 \xe0 x."),(0,r.kt)("p",null,"A l'inverse, ",(0,r.kt)("em",{parentName:"p"},"id")," est un num\xe9ro unique assign\xe9 \xe0 un message lorsqu'il a \xe9t\xe9 re\xe7u par le serveur. Ce num\xe9ro est calcul\xe9 \xe0 l'aide de l'heure et de la date de r\xe9ception du message et sa valeur est assign\xe9e par votre serveur POP3. Malheureusement, les serveurs POP3 n'utilisent pas l'",(0,r.kt)("em",{parentName:"p"},"id")," comme r\xe9f\xe9rence primaire \xe0 leurs messages. Durant les sessions POP3, vous aurez besoin d'indiquer le ",(0,r.kt)("em",{parentName:"p"},"number")," comme r\xe9f\xe9rence aux messages du serveur. Les d\xe9veloppeurs doivent \xeatre vigilants s'ils d\xe9veloppent des solutions qui importent des r\xe9f\xe9rences aux messages dans une base de donn\xe9es tout en laissant le corps du message sur le serveur."),(0,r.kt)("h5",a({},{id:"exemple-6"}),"Exemple"),(0,r.kt)("p",null,"Vous souhaitez connaitre le nombre total d'emails de la bo\xeete de r\xe9ception ainsi que leur taille :"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $server : Object\n $server:=New object\n $server.host:="pop.gmail.com" //Obligatoire\n $server.port:=995\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n var $transporter : 4D.POP3Transporter\n $transporter:=POP3 New transporter($server)\n\n C_COLLECTION($mailInfo)\n C_LONGINT($vNum;$vSize)\n\n $mailInfo:=$transporter.getMailInfoList()\n $vNum:=$mailInfo.length\n $vSize:=$mailInfo.sum("size")\n\n ALERT("The mailbox contains "+String($vNum)+" message(s) for "+String($vSize)+" bytes.")\n')),(0,r.kt)("h2",a({},{id:"getmimeasblob"}),".getMIMEAsBlob()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R3"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMIMEAsBlob"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : Integer ) : Blob\n| Param\xe8tres | Type    |    | Description                                                                      |\n| ---------- | ------- |:--:| -------------------------------------------------------------------------------- |\n| msgNumber  | Integer | -> | Num\xe9ro du message dans la liste                                                  |\n| Result     | Blob    | <- | Blob of the MIME string returned from the mail server|\n|"),(0,r.kt)("h5",a({},{id:"description-11"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".copy()")," function The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," function."),(0,r.kt)("p",null,"Dans le param\xe8tre ",(0,r.kt)("em",{parentName:"p"},"msgNumber"),", passez le num\xe9ro de l'email \xe0 r\xe9cup\xe9rer. Ce num\xe9ro est retourn\xe9 dans la propri\xe9t\xe9 number par la fonction ",(0,r.kt)("a",a({parentName:"p"},{href:"#getmailinfolist"}),(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()")),"."),(0,r.kt)("p",null,"La fonction retourne un Blob vide si :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"msgNumber")," d\xe9signe un message inexistant,"),(0,r.kt)("li",{parentName:"ul"},"le message a \xe9t\xe9 marqu\xe9 pour suppression \xe0 l'aide de ",(0,r.kt)("inlineCode",{parentName:"li"},".delete()"),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"BLOB retourn\xe9")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," retourne un ",(0,r.kt)("inlineCode",{parentName:"p"},"BLOB")," qui peut \xeatre archiv\xe9 dans une base de donn\xe9es ou converti en un objet ",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/fr/next/API/EmailObjectClass#objet-email"}),(0,r.kt)("inlineCode",{parentName:"a"},"Email"))," avec la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"MAIL Convert from MIME"),"."),(0,r.kt)("h5",a({},{id:"exemple-7"}),"Exemple"),(0,r.kt)("p",null,"Vous souhaitez connaitre le nombre total d'emails de la bo\xeete de r\xe9ception ainsi que leur taille :"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' var $server : Object\n var $mailInfo : Collection\n var $blob : Blob\n var $transporter : 4D.POP3Transporter\n\n $server:=New object\n $server.host:="pop.gmail.com"\n $server.port:=995\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=POP3 New transporter($server)\n\n $mailInfo:=$transporter.getMailInfoList()\n $blob:=$transporter.getMIMEAsBlob($mailInfo[0].number)\n')),(0,r.kt)("h2",a({},{id:"host"}),".host"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R5"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".host")," : Text"),(0,r.kt)("h4",a({},{id:"description-12"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".host")," property contains the name or the IP address of the host server. Utilis\xe9e pour les \xe9changes de courrier (SMTP, POP3, IMAP)."),(0,r.kt)("h2",a({},{id:"logfile"}),".logFile"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R5"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".logFile")," : Text"),(0,r.kt)("h4",a({},{id:"description-13"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".logFile")," property contains the path of the extended log file defined (if any) for the mail connection. Elle peut \xeatre relative (au dossier Logs courant) ou absolue."),(0,r.kt)("p",null,"Contrairement aux fichiers log habituels (activ\xe9s via la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"SET DATABASE PARAMETER"),"), les fichiers log \xe9tendus stockent le contenu MIME de tous les emails envoy\xe9s et n'ont pas de limite de taille. Pour plus d'informations sur les fichiers log \xe9tendus, reportez-vous \xe0 :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Connexions SMTP")," - ",(0,r.kt)("a",a({parentName:"li"},{href:"/docs/fr/next/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt"}),"4DSMTPLog.txt")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Connexions POP3")," - ",(0,r.kt)("a",a({parentName:"li"},{href:"/docs/fr/next/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt"}),"4DPOP3Log.txt")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Connexions IMAP")," - ",(0,r.kt)("a",a({parentName:"li"},{href:"/docs/fr/next/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt"}),"4DIMAPLog.txt"))),(0,r.kt)("h2",a({},{id:"port"}),".port"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R4"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".port")," : Integer"),(0,r.kt)("h4",a({},{id:"description-14"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".port")," property contains  the port number used for mail transactions. Par d\xe9faut, si la propri\xe9t\xe9 ",(0,r.kt)("em",{parentName:"p"},"port")," n'a pas \xe9t\xe9 d\xe9finie dans l'objet ",(0,r.kt)("em",{parentName:"p"},"server")," (utilis\xe9 pour cr\xe9er l'objet transporteur avec ",(0,r.kt)("inlineCode",{parentName:"p"},"SMTP New transporter"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 New transporter"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"IMAP New transporter"),"), le port utilis\xe9 est :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"SMTP")," - 587"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"POP3")," - 995"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMAP")," - 993")),(0,r.kt)("h2",a({},{id:"undeleteall"}),".undeleteAll()"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v18 R2"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".undeleteAll()"),"\n| Param\xe8tres | Type |  | Description                                            |\n| ---------- | ---- |::| ------------------------------------------------------ |\n|            |      |  | Ne requiert aucun param\xe8tre|\n|"),(0,r.kt)("h5",a({},{id:"description-15"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".undeleteAll()")," function removes all delete flags set on the emails in the ",(0,r.kt)("a",a({parentName:"p"},{href:"#pop3-transporter-object"}),(0,r.kt)("inlineCode",{parentName:"a"},"POP3_transporter")),"."),(0,r.kt)("h2",a({},{id:"user"}),".user"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Historique"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Version"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Modifications"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"v17 R4"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"Ajout\xe9es"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".user")," : Text"),(0,r.kt)("h4",a({},{id:"description-16"}),"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".user")," property contains  the user name used for authentication on the mail server."))}d.isMDXComponent=!0}}]);