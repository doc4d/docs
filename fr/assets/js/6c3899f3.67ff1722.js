"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[81074],{603905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>k});var a=n(667294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=s(n),k=r,m=c["".concat(p,".").concat(k)]||c[k]||u[k]||l;return n?a.createElement(m,o(o({ref:t},d),{},{components:n})):a.createElement(m,o({ref:t},d))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=c;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},968245:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>p,toc:()=>d});n(667294);var a=n(603905);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r.apply(this,arguments)}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const o={id:"WebSocketClass",title:"WebSocket"},i=void 0,p={unversionedId:"API/WebSocketClass",id:"version-20-R5/API/WebSocketClass",title:"WebSocket",description:"La classe WebSocket permet d'ouvrir une connexion cliente WebSocket avec un serveur, d'envoyer et de recevoir des donn\xe9es et de fermer la connexion.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R5/API/WebSocketClass.md",sourceDirName:"API",slug:"/API/WebSocketClass",permalink:"/docs/fr/API/WebSocketClass",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FWebSocketClass.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"WebSocketClass",title:"WebSocket"},sidebar:"docs",previous:{title:"WebServer",permalink:"/docs/fr/API/WebServerClass"},next:{title:"WebSocketConnection",permalink:"/docs/fr/API/WebSocketConnectionClass"}},s={},d=[{value:"Exemple",id:"exemple",level:3},{value:"Objet WebSocket",id:"objet-websocket",level:3},{value:"4D.WebSocket.new()",id:"4dwebsocketnew",level:2},{value:"Param\xe8tre <em>connectionHandler</em>",id:"param\xe8tre-connectionhandler",level:3},{value:"Exemple",id:"exemple-1",level:4},{value:".dataType",id:"datatype",level:2},{value:"Description",id:"description",level:4},{value:".handler",id:"handler",level:2},{value:"Description",id:"description-1",level:4},{value:".id",id:"id",level:2},{value:"Description",id:"description-2",level:4},{value:".send()",id:"send",level:2},{value:"Description",id:"description-3",level:4},{value:".status",id:"status",level:2},{value:"Description",id:"description-4",level:4},{value:".terminate()",id:"terminate",level:2},{value:"Description",id:"description-5",level:4},{value:".url",id:"url",level:2},{value:"Description",id:"description-6",level:4}],u={toc:d};function c(e){var{components:t}=e,n=l(e,["components"]);return(0,a.kt)("wrapper",r({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"La classe ",(0,a.kt)("inlineCode",{parentName:"p"},"WebSocket")," permet d'ouvrir une connexion cliente WebSocket avec un serveur, d'envoyer et de recevoir des donn\xe9es et de fermer la connexion."),(0,a.kt)("p",null,"Les connexions clientes WebSocket sont utiles, par exemple, pour recevoir des donn\xe9es financi\xe8res en temps r\xe9el ou pour envoyer et recevoir des messages \xe0 partir d'une messagerie instantan\xe9e."),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Historique"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"20 R2"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,a.kt)("h3",r({},{id:"exemple"}),"Exemple"),(0,a.kt)("p",null,"Dans cet exemple, nous cr\xe9ons un client WebSocket tr\xe8s basique."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez la classe utilisateur ",(0,a.kt)("inlineCode",{parentName:"li"},"WSConnectionHandler")," contenant la ou les fonction(s) de callback utilis\xe9e(s) pour g\xe9rer les callbacks d'\xe9v\xe9nements WebSocket :")),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'// WSConnectionHandler class\n\nClass constructor\n\nFunction onMessage($ws : 4D.WebSocket; $event : Object)\n   ALERT($event.data)\n\nFunction onTerminate($ws : 4D.WebSocket; $event : Object)\n   ALERT("Connection closed")\n')),(0,a.kt)("ol",r({},{start:2}),(0,a.kt)("li",{parentName:"ol"},"Connexion au serveur WebSocket \xe0 partir d'un formulaire 4D en instanciant un 4D.WebSocket :")),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-4d"}),"Form.webSocket:=4D.WebSocket.new($wssUrl; cs.WSConnectionHandler.new())\n")),(0,a.kt)("ol",r({},{start:3}),(0,a.kt)("li",{parentName:"ol"},"Pour envoyer des messages au serveur WebSocket \xe0 partir du formulaire 4D, vous pouvez \xe9crire :")),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'Form.webSocket.send("Hello world")\n\n')),(0,a.kt)("h3",r({},{id:"objet-websocket"}),"Objet WebSocket"),(0,a.kt)("p",null,"Les objets WebSocket exposent les propri\xe9t\xe9s et fonctions suivantes :"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null})))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#dataType"}),(0,a.kt)("strong",{parentName:"a"},".dataType")," : Text"),(0,a.kt)("br",null),"the type of the response body content")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#handler"}),(0,a.kt)("strong",{parentName:"a"},".handler")," : Object"),(0,a.kt)("br",null),"the accessor that gets the ",(0,a.kt)("inlineCode",{parentName:"td"},"connectionHandler")," object used to initiate the connection")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#id"}),(0,a.kt)("strong",{parentName:"a"},".id")," : Longint"),(0,a.kt)("br",null),"the unique identifier of the connection")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#send"}),(0,a.kt)("strong",{parentName:"a"},".send"),"( ",(0,a.kt)("em",{parentName:"a"},"message")," : Text )",(0,a.kt)("br",null),(0,a.kt)("strong",{parentName:"a"},".send"),"( ",(0,a.kt)("em",{parentName:"a"},"message")," : Blob )",(0,a.kt)("br",null),(0,a.kt)("strong",{parentName:"a"},".send"),"( ",(0,a.kt)("em",{parentName:"a"},"message")," : Object )"),(0,a.kt)("br",null),"sends ",(0,a.kt)("em",{parentName:"td"},"message")," to the WebSocket server in the defined data type (Text, Blob, or Object)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#status"}),(0,a.kt)("strong",{parentName:"a"},".status")," : Text"),(0,a.kt)("br",null),'the current connection status (can be "Connecting", "Closing", "Closed", or "Connected")')),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#terminate"}),(0,a.kt)("strong",{parentName:"a"},".terminate"),"( { ",(0,a.kt)("em",{parentName:"a"},"code")," : Integer { ; ",(0,a.kt)("em",{parentName:"a"},"reason")," : Text } } )"),(0,a.kt)("br",null),"closes the WebSocket connection, along with optional ",(0,a.kt)("em",{parentName:"td"},"code")," and ",(0,a.kt)("em",{parentName:"td"},"reason")," parameters")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#url"}),(0,a.kt)("strong",{parentName:"a"},".url")," : Text"),(0,a.kt)("br",null),"the URL to which the WebSocket has connected")))),(0,a.kt)("h2",r({},{id:"4dwebsocketnew"}),"4D.WebSocket.new()"),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Historique"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"20 R3"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Prise en charge de la propri\xe9t\xe9 ",(0,a.kt)("inlineCode",{parentName:"td"},"headers")," dans ",(0,a.kt)("em",{parentName:"td"},"connectionHandler")))))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"4D.WebSocket.new"),"( ",(0,a.kt)("em",{parentName:"p"},"url")," : Text { ; ",(0,a.kt)("em",{parentName:"p"},"connectionHandler")," : Object } ) : 4D.WebSocket"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:"center"})),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"url"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"URL \xe0 laquelle se connecter")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"#connectionHandler-parameter"}),"connectionHandler")),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,a.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Objet d\xe9clarant les callbacks WebSocket")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"4D.WebSocket"),(0,a.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Nouvel ",(0,a.kt)("a",r({parentName:"td"},{href:"#websocket-object"}),"objet WebSocket"))))),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"4D.WebSocket.new()")," function creates and returns a new ",(0,a.kt)("a",r({parentName:"p"},{href:"#websocket-object"}),(0,a.kt)("inlineCode",{parentName:"a"},"4D.WebSocket")," object")," connected to the WebSocket server at the address you passed in ",(0,a.kt)("em",{parentName:"p"},"url"),". L'objet ",(0,a.kt)("inlineCode",{parentName:"p"},"4D.WebSocket")," fournit une API pour la cr\xe9ation et la gestion d'une connexion WebSocket \xe0 un serveur, ainsi que pour l'envoi et la r\xe9ception de donn\xe9es vers et depuis le serveur."),(0,a.kt)("p",null,"Dans ",(0,a.kt)("em",{parentName:"p"},"url"),", indiquez l'URL \xe0 laquelle le serveur WebSocket r\xe9pondra. Les mod\xe8les d'URL suivants peuvent \xeatre utilis\xe9s :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ws://host[:port]path[?query]")," pour les connexions standard"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"wss://host[:port]path[?query]")," pour les connexions TLS s\xe9curis\xe9es")),(0,a.kt)("p",null,"Si la connexion n'est pas possible, un objet ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," est renvoy\xe9 et une erreur est g\xe9n\xe9r\xe9e (que vous pouvez intercepter \xe0 l'aide d'une m\xe9thode install\xe9e avec ",(0,a.kt)("inlineCode",{parentName:"p"},"ON ERR CALL"),")."),(0,a.kt)("h3",r({},{id:"param\xe8tre-connectionhandler"}),"Param\xe8tre ",(0,a.kt)("em",{parentName:"h3"},"connectionHandler")),(0,a.kt)("p",null,"Dans ",(0,a.kt)("em",{parentName:"p"},"connectionHandler"),", vous pouvez transmettre un objet contenant des fonctions de callback \xe0 appeler selon les \xe9v\xe9nements de connexion, ainsi que le type de donn\xe9es et les en-t\xeates \xe0 g\xe9rer."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Les callbacks sont automatiquement appel\xe9es dans le contexte du formulaire ou du worker qui initie la connexion."),(0,a.kt)("li",{parentName:"ul"},"La WebSocket reste valide tant que le formulaire ou le worker n'est pas ferm\xe9.")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"onMessage"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"/docs/fr/API/FunctionClass"}),"Function")),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Fonction de callback pour les donn\xe9es WebSocket. Appel\xe9e \xe0 chaque fois que le WebSocket a re\xe7u des donn\xe9es. The callback receives the following parameters:",(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$1"),": WebSocket object"),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2"),": Object"),(0,a.kt)("ul",null,(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.type"),' (text): always "message"'),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.data")," (text, blob, or object, see ",(0,a.kt)("inlineCode",{parentName:"td"},"dataType"),"): Received data")))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"onError"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"/docs/fr/API/FunctionClass"}),"Function")),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Fonction de callback pour les erreurs d'ex\xe9cution. The callback receives the following parameters:",(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$1"),": WebSocket object"),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2"),": Object"),(0,a.kt)("ul",null,(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.type"),' (text): always "error"'),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.errors"),": collection of 4D errors stack in case of execution error.",(0,a.kt)("ul",null,(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"[].errCode")," (number): 4D error code"),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"[].message")," (text): Description of the 4D error"),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"[].componentSignature")," (text): Signature of the internal component which returned the error")))))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"onTerminate"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"/docs/fr/API/FunctionClass"}),"Function")),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Fonction de callback lorsque la WebSocket est termin\xe9e. The callback receives the following parameters:",(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$1"),": WebSocket object"),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2"),": Object"),(0,a.kt)("ul",null,(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.code")," (number, read-only): unsigned short containing the close code sent by the server."),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.reason")," (text, read-only): Reason why the server closed the connection. This is specific to the particular server and sub-protocol.")))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"onOpen"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("a",r({parentName:"td"},{href:"/docs/fr/API/FunctionClass"}),"Function")),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Fonction de callback lorsque la WebSocket est ouverte. The callback receives the following parameters:",(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$1"),": WebSocket object"),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2"),": Object"),(0,a.kt)("ul",null,(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"$2.type"),' (text): always "open"')))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"dataType"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),'Type de donn\xe9es re\xe7ues ou envoy\xe9es. Valeurs disponibles : "text" (par d\xe9faut), "blob", "object". "text" = utf-8')),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"headers"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Headers of the WebSocket.",(0,a.kt)("li",null,"Syntax for standard key assignment: ",(0,a.kt)("inlineCode",{parentName:"td"},"headers.*key*:=*value*")," (",(0,a.kt)("em",{parentName:"td"},"value")," can be a Collection if the same key appears multiple times)"),(0,a.kt)("li",null,"Syntax for Cookie assignment (particular case): ",(0,a.kt)("inlineCode",{parentName:"td"},'headers.Cookie:="*name*=*value* {; *name2*=*value2*{; ... } }"')))))),(0,a.kt)("p",null,"Voici la s\xe9quence des appels de callbacks :"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"onOpen")," est ex\xe9cut\xe9 une fois"),(0,a.kt)("li",{parentName:"ol"},"Z\xe9ro ou plusieurs ",(0,a.kt)("inlineCode",{parentName:"li"},"onMessage")," sont ex\xe9cut\xe9s"),(0,a.kt)("li",{parentName:"ol"},"Z\xe9ro ou un ",(0,a.kt)("inlineCode",{parentName:"li"},"onError")," est ex\xe9cut\xe9 (stoppe le traitement)"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"onTerminate")," est toujours ex\xe9cut\xe9")),(0,a.kt)("h4",r({},{id:"exemple-1"}),"Exemple"),(0,a.kt)("p",null,"Vous souhaitez d\xe9finir des en-t\xeates dans la classe utilisateur ",(0,a.kt)("inlineCode",{parentName:"p"},"WSConnectionHandler")," :"),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'// WSConnectionHandler class\n\nClass constructor($myToken:Text)\n\n// Creation of the headers sent to the server\nThis.headers:=New object("x-authorization";$myToken)\n// We define two cookies\nThis.headers.Cookie:="yummy_cookie=choco; tasty_cookie=strawberry"\n...\n\n')),(0,a.kt)("h2",r({},{id:"datatype"}),".dataType"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".dataType")," : Text"),(0,a.kt)("h4",r({},{id:"description"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".dataType"),' property contains the type of the response body content. Peut \xeatre "text", "blob" ou "object".'),(0,a.kt)("p",null,"Cette propri\xe9t\xe9 est en lecture seule."),(0,a.kt)("h2",r({},{id:"handler"}),".handler"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".handler")," : Object"),(0,a.kt)("h4",r({},{id:"description-1"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".handler")," property contains the accessor that gets the ",(0,a.kt)("inlineCode",{parentName:"p"},"connectionHandler")," object used to initiate the connection."),(0,a.kt)("p",null,"Cette propri\xe9t\xe9 est en lecture seule."),(0,a.kt)("h2",r({},{id:"id"}),".id"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".id")," : Longint"),(0,a.kt)("h4",r({},{id:"description-2"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".id")," property contains the unique identifier of the connection."),(0,a.kt)("p",null,"Cette propri\xe9t\xe9 est en lecture seule."),(0,a.kt)("h2",r({},{id:"send"}),".send()"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".send"),"( ",(0,a.kt)("em",{parentName:"p"},"message")," : Text )",(0,a.kt)("br",null),(0,a.kt)("strong",{parentName:"p"},".send"),"( ",(0,a.kt)("em",{parentName:"p"},"message")," : Blob )",(0,a.kt)("br",null),(0,a.kt)("strong",{parentName:"p"},".send"),"( ",(0,a.kt)("em",{parentName:"p"},"message")," : Object )"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:"center"})),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"message"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text, Blob, Object"),(0,a.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Message \xe0 envoyer")))),(0,a.kt)("h4",r({},{id:"description-3"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".send()")," function sends ",(0,a.kt)("em",{parentName:"p"},"message")," to the WebSocket server in the defined data type (Text, Blob, or Object)."),(0,a.kt)("p",null,"Les contenus suivants sont envoy\xe9s en fonction du type de ","*","message ","*"," :"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Contenu"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Texte en UTF-8")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Blob"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Donn\xe9es binaires")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text in JSON UTF-8 (same result as with ",(0,a.kt)("a",r({parentName:"td"},{href:"https://doc.4d.com/4dv20/help/command/en/page1217.html"}),(0,a.kt)("inlineCode",{parentName:"a"},"JSON Stringify")),")")))),(0,a.kt)("h2",r({},{id:"status"}),".status"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".status")," : Text"),(0,a.kt)("h4",r({},{id:"description-4"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".status"),' property contains the current connection status (can be "Connecting", "Closing", "Closed", or "Connected").'),(0,a.kt)("p",null,"Cette propri\xe9t\xe9 est en lecture seule."),(0,a.kt)("h2",r({},{id:"terminate"}),".terminate()"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".terminate"),"( { ",(0,a.kt)("em",{parentName:"p"},"code")," : Integer { ; ",(0,a.kt)("em",{parentName:"p"},"reason")," : Text } } )"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:"center"})),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"code"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,a.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Code de statut indiquant la cause de la fermeture de la connexion")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"reason"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Cause de la fermeture de la connexion")))),(0,a.kt)("h4",r({},{id:"description-5"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".terminate()")," function closes the WebSocket connection, along with optional ",(0,a.kt)("em",{parentName:"p"},"code")," and ",(0,a.kt)("em",{parentName:"p"},"reason")," parameters."),(0,a.kt)("p",null,"Dans ",(0,a.kt)("em",{parentName:"p"},"code"),", vous pouvez passer un code d'\xe9tat expliquant pourquoi la connexion est ferm\xe9e (voir aussi ",(0,a.kt)("a",r({parentName:"p"},{href:"https://www.rfc-editor.org/rfc/rfc6455.html#section-7.1.5"}),"WebSocket Connection Close Code in the RFC6455"),") :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"S'il n'est pas sp\xe9cifi\xe9, le code de fermeture de la connexion est automatiquement fix\xe9 \xe0 1000 pour une fermeture normale, ou \xe0 une autre valeur standard dans la plage 1001-1015 qui indique la raison r\xe9elle de la fermeture de la connexion."),(0,a.kt)("li",{parentName:"ul"},"Si elle est sp\xe9cifi\xe9e, la valeur de ce param\xe8tre de code remplace le r\xe9glage automatique. La valeur doit \xeatre un nombre entier. Soit 1000, soit un code personnalis\xe9 compris entre 3000 et 4999. Si vous sp\xe9cifiez la valeur du ","*","code ","*"," , vous devez \xe9galement sp\xe9cifier une ",(0,a.kt)("em",{parentName:"li"},"reason"),".")),(0,a.kt)("p",null,"Dans ",(0,a.kt)("em",{parentName:"p"},"reason"),", vous pouvez passer une cha\xeene de caract\xe8res d\xe9crivant la raison pour laquelle la connexion est ferm\xe9e."),(0,a.kt)("h2",r({},{id:"url"}),".url"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},".url")," : Text"),(0,a.kt)("h4",r({},{id:"description-6"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},".url")," property contains the URL to which the WebSocket has connected. It is the URL you passed to the ",(0,a.kt)("a",r({parentName:"p"},{href:"#4dwebsocketnew"}),(0,a.kt)("inlineCode",{parentName:"a"},"new()"))," function."),(0,a.kt)("p",null,"Cette propri\xe9t\xe9 est en lecture seule."))}c.isMDXComponent=!0}}]);